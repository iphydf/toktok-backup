{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "As requested, this is a summary of https://github.com/irungentoo/toxcore/issues/1313. More details can be found there. Keep in mind that the discussion was held a while back so some details may no longer match against the current protocol/codebase. \r\n\r\n*Basic idea*\r\nThe basic idea is that security can be improved through a better use of nonces. Specifically, the nonce can be used to prevent replay attacks, if used correctly. To do this, a nonce must be different for every message between a sender and receiver. This is currently done on the sender's side, but it isn't verified on the receiver's side, which still makes replay attacks possible. A common tactic that allows clients to verify that a nonce is only used once, is to use strictly increasing nonces. This means the sender will always increase the nonce value, so the receiver can verify that the received nonce is larger than the previously received nonce value from this sender. Note that the sender and receiver for a request message have their roles reversed for the corresponding response message, as the sender of the response is the receiver of the request and the receiver of the response is the sender of the request. These responses will also need their own nonce value which must be different from the nonce value in the request, and should in fact belong to an entirely different strictly-increasing set of nonce values. \r\n\r\n*Proposed implementation*\r\nThe proposal is to have the receivers verify that the nonce values are unique, e.g. by making them strictly increasing. The Ping messages can be used as nonce announcements and acknowledgements, which allows for optimizing the communication between the sender and receiver. These nonce announcements will be used to send the full nonce value to a receiver. The nonce values will be predictably incremented on both the sender and receiver's side (e.g. +1). Each encrypted message will then only need to carry a nonce_offset value or the last few bytes of the nonce value, to allow the client to verify that it has calculated the correct new nonce value for this encrypted message. \r\n\r\n*Plan for implementation*\r\n* Make the sender send strictly increasing nonce values and have the receiver verify that the current nonce value in each encrypted message is larger than the last known nonce value for this sender (this will prevent replay attacks, the rest is just optimization)\r\n* Use the ping messages to send the full nonce value as announcement and acknowledgement\r\n* Reduce the size of the nonce values in each encrypted message to just an offset or last few bytes. ",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks. If I understand correctly, this is a protocol breaking change. As such, I have assigned it to the preliminary 0.3.0 milestone, as I doubt we can implement this before 0.2.0.",
            "created_at": "2017-01-05T09:14:12Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/356#issuecomment-270597462",
            "id": 270597462,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDU5NzQ2Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/270597462/reactions"
            },
            "updated_at": "2017-01-05T09:14:12Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/270597462",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356/comments",
    "created_at": "2016-12-23T08:06:03Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-01-05T09:13:08Z",
            "event": "milestoned",
            "id": 912363048,
            "milestone": {
                "title": "v0.3.0"
            },
            "node_id": "MDE1Ok1pbGVzdG9uZWRFdmVudDkxMjM2MzA0OA==",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/912363048"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-01-10T17:57:44Z",
            "event": "demilestoned",
            "id": 917912263,
            "milestone": {
                "title": "v0.3.0"
            },
            "node_id": "MDE3OkRlbWlsZXN0b25lZEV2ZW50OTE3OTEyMjYz",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/917912263"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-01-10T17:57:44Z",
            "event": "demilestoned",
            "id": 917912264,
            "milestone": {
                "title": "v0.3.0"
            },
            "node_id": "MDE3OkRlbWlsZXN0b25lZEV2ZW50OTE3OTEyMjY0",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/917912264"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-01-12T12:39:20Z",
            "event": "labeled",
            "id": 920654604,
            "label": {
                "color": "eb6420",
                "name": "P-low"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDkyMDY1NDYwNA==",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/920654604"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2018-07-16T21:04:34Z",
            "event": "milestoned",
            "id": 1736262928,
            "milestone": {
                "title": "v0.2.x"
            },
            "node_id": "MDE1Ok1pbGVzdG9uZWRFdmVudDE3MzYyNjI5Mjg=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/1736262928"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2022-02-04T09:37:21Z",
            "event": "demilestoned",
            "id": 6008243560,
            "milestone": {
                "title": "v0.2.x"
            },
            "node_id": "DEME_lADOA7zIGs4LwvynzwAAAAFmHoVo",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/6008243560"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2022-02-04T09:37:21Z",
            "event": "milestoned",
            "id": 6008243565,
            "milestone": {
                "title": "v0.3.0"
            },
            "node_id": "MIE_lADOA7zIGs4LwvynzwAAAAFmHoVt",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/6008243565"
        }
    ],
    "events_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356/events",
    "html_url": "https://github.com/TokTok/c-toxcore/issues/356",
    "id": 197328039,
    "labels": [
        {
            "color": "eeeeee",
            "default": false,
            "description": "Low priority",
            "id": 406490432,
            "name": "P3",
            "node_id": "MDU6TGFiZWw0MDY0OTA0MzI=",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/labels/P3"
        }
    ],
    "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 0,
        "created_at": "2016-11-02T21:32:06Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
            "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
            "followers_url": "https://api.github.com/users/iphydf/followers",
            "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
            "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/iphydf",
            "id": 10647936,
            "login": "iphydf",
            "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
            "organizations_url": "https://api.github.com/users/iphydf/orgs",
            "received_events_url": "https://api.github.com/users/iphydf/received_events",
            "repos_url": "https://api.github.com/users/iphydf/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/iphydf"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/TokTok/c-toxcore/milestone/10",
        "id": 2110794,
        "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/10/labels",
        "node_id": "MDk6TWlsZXN0b25lMjExMDc5NA==",
        "number": 10,
        "open_issues": 33,
        "state": "open",
        "title": "v0.3.0",
        "updated_at": "2024-02-17T22:16:29Z",
        "url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/10"
    },
    "node_id": "MDU6SXNzdWUxOTczMjgwMzk=",
    "number": 356,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356/reactions"
    },
    "repository_url": "https://api.github.com/repos/TokTok/c-toxcore",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356/timeline",
    "title": "Improving security through better use of nonces",
    "updated_at": "2022-02-04T09:37:21Z",
    "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/356",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/5629937?v=4",
        "events_url": "https://api.github.com/users/arucard21/events{/privacy}",
        "followers_url": "https://api.github.com/users/arucard21/followers",
        "following_url": "https://api.github.com/users/arucard21/following{/other_user}",
        "gists_url": "https://api.github.com/users/arucard21/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/arucard21",
        "id": 5629937,
        "login": "arucard21",
        "node_id": "MDQ6VXNlcjU2Mjk5Mzc=",
        "organizations_url": "https://api.github.com/users/arucard21/orgs",
        "received_events_url": "https://api.github.com/users/arucard21/received_events",
        "repos_url": "https://api.github.com/users/arucard21/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/arucard21/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/arucard21/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/arucard21"
    }
}