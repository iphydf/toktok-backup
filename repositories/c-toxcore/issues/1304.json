{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "Currently, qTox shows audio groups as if they have an \"in call\" state. If not \"in call\", qTox sends no audio, and discards all received audio from peers.\r\n\r\nI think the ability for users to be in an audio group, but not sending audio is valuable since text chat can still be used with the same group of people, but the implementation qTox uses means that even if we're not in the call, all peers who are in the group call are sending us their audio, which Toxcore decrypts, decodes, then passes to qTox which we immediately discard.\r\n\r\nIt would be better (more efficient) if Toxcore could be aware of \"in call\" state, and communicate that to peers in the group, so that the peers can only send audio data when we're \"in call\", saving bandwidth/CPU.\r\n\r\nPeers being aware of us being \"in call\" also allow users with no mic to be \"in call\" where they're listening but not transmitting. Clients could use this info to annotate peers in the group as in call / listening without having to do what qTox does now of just considering peers who have recently sent us audio frames as being in call.\r\n\r\nThe implementation I'm thinking of would require a new packet type to indicate \"I'm not in a call\" and \"I'm joining the call\" that the peers should respect. Toxcore could also handle the discarding of audio frames before decoding if it knows that we're not in a call.",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "* Wednesday, 2019-01-23 at 15:44 -0800 - Anthony Bilinski <notifications@github.com>:\n\n>the ability for users to be in an audio group, but not sending audio\n\nThis might also be a good solution to #1303. Enabling audio sending \nimmediately on loading a saved persistent audio group could catch users \nby surprise -- I think it's best that the user always has to explicitly \ninitiate any av sending. So you should start \"out of call\" in a loaded \naudio group.\n\n>The implementation I'm thinking of would require a new packet type to \n>indicate \"I'm not in a call\" and \"I'm joining the call\" the the peers \n>should respect. \n\nThis sounds straightforward, except:\n\n1. There are the usual synchronisation issues - peers might occasionally \nmiss announcemnets of other peers' call status changes. But probably to \ndeal with this it's enough that sending an audio frame is interpreted by \nother peers as indicating that the peer is in call, and that a peer not \nin call who receives an audio frame repeats its announcement that it's \nnot in call.\n\n2. Backwards compatibility would be tricky. Lots to think about there.\n\n\nI suggest we first implement the part of this which doesn't require \na protocol change: namely, having a way for clients to start and stop \nthe audio component of a group (both directions). As far as toxcore is \nconcerned, this should basically just mean exposing \ngroupchat_enable_av() from groupav.c in the toxav API, and introducing \nand exposing a corresponding groupchat_disable_av(). Then clients would \nhave to work out the UI for it.\n\nThat's enough to fix #1303 - clients just need to understand that \na loaded audio group won't have audio enabled at first, so the client \nshouldn't try to send audio to it.\n\nIt won't stop peers unnecessarily sending us audio frames, but it will \nstop us wasting CPU decoding them (though we'll still decrypt them).\n",
            "created_at": "2019-01-24T20:41:05Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/1304#issuecomment-457348303",
            "id": 457348303,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NzM0ODMwMw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/457348303/reactions"
            },
            "updated_at": "2019-01-24T20:41:05Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/457348303",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304/comments",
    "created_at": "2019-01-23T23:44:45Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-24T14:33:35Z",
            "event": "milestoned",
            "id": 3269692963,
            "milestone": {
                "title": "v0.2.x"
            },
            "node_id": "MDE1Ok1pbGVzdG9uZWRFdmVudDMyNjk2OTI5NjM=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/3269692963"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-27T23:35:47Z",
            "event": "labeled",
            "id": 3277994012,
            "label": {
                "color": "eeeeee",
                "name": "P3"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDMyNzc5OTQwMTI=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/3277994012"
        }
    ],
    "events_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304/events",
    "html_url": "https://github.com/TokTok/c-toxcore/issues/1304",
    "id": 402479735,
    "labels": [
        {
            "color": "eeeeee",
            "default": false,
            "description": "Low priority",
            "id": 406490432,
            "name": "P3",
            "node_id": "MDU6TGFiZWw0MDY0OTA0MzI=",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/labels/P3"
        }
    ],
    "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 0,
        "created_at": "2018-03-09T13:13:48Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
            "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
            "followers_url": "https://api.github.com/users/iphydf/followers",
            "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
            "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/iphydf",
            "id": 10647936,
            "login": "iphydf",
            "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
            "organizations_url": "https://api.github.com/users/iphydf/orgs",
            "received_events_url": "https://api.github.com/users/iphydf/received_events",
            "repos_url": "https://api.github.com/users/iphydf/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/iphydf"
        },
        "description": "Placeholder for the next 0.2.x version.",
        "due_on": null,
        "html_url": "https://github.com/TokTok/c-toxcore/milestone/28",
        "id": 3174131,
        "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/28/labels",
        "node_id": "MDk6TWlsZXN0b25lMzE3NDEzMQ==",
        "number": 28,
        "open_issues": 124,
        "state": "open",
        "title": "v0.2.x",
        "updated_at": "2024-02-21T10:27:33Z",
        "url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/28"
    },
    "node_id": "MDU6SXNzdWU0MDI0Nzk3MzU=",
    "number": 1304,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304/reactions"
    },
    "repository_url": "https://api.github.com/repos/TokTok/c-toxcore",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304/timeline",
    "title": "[Proposal] Have \"in call\" state for AV groups, don't send audio data if peer not \"in call\"",
    "updated_at": "2020-04-27T23:35:48Z",
    "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/1304",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10469203?v=4",
        "events_url": "https://api.github.com/users/anthonybilinski/events{/privacy}",
        "followers_url": "https://api.github.com/users/anthonybilinski/followers",
        "following_url": "https://api.github.com/users/anthonybilinski/following{/other_user}",
        "gists_url": "https://api.github.com/users/anthonybilinski/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/anthonybilinski",
        "id": 10469203,
        "login": "anthonybilinski",
        "node_id": "MDQ6VXNlcjEwNDY5MjAz",
        "organizations_url": "https://api.github.com/users/anthonybilinski/orgs",
        "received_events_url": "https://api.github.com/users/anthonybilinski/received_events",
        "repos_url": "https://api.github.com/users/anthonybilinski/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/anthonybilinski/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/anthonybilinski/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/anthonybilinski"
    }
}