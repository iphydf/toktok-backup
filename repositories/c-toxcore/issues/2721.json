{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "currently in PGC conferences if there are 5 peers in a group, the peerlist will always show those 5 peers.\r\neven if some of them are offline.\r\n\r\nin NGC this is not the case. so you never know who is acutally a member of the group currently.\r\n\r\nthe peer list should be stable and consistent. and show all peers unless they are kicked out or actually exit the group.\r\ngoing offline should not remove the peer from the list.",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "What if a peer exits or gets kicked out while you are offline? Since you didn't observe that event, the peer would still remain in your peer list when they really shouldn't. Sounds rather complex, as this would require peer list synchronization among group chat peers and conflict resolution in order to function properly, and even then some events might get missed by multiple peers you are synchronizing your peer list with and you might still end up with peers being listed in your peer list despite them have exited or being kicked out, having to perform some sort of a peer list cleanup periodically.\r\n\r\nOr perhaps it's fine if the peer list is not synchronized with other group chat peers to account for the events that you didn't observe, i.e. if it's just your personal observation peer list? For example, in addition to the currently online peer list, a client would display a list of offline peers that the client has previously observed being online, something like \"Peers seen in the last N days\" or \"Last N offline peers\". While toxcore could keep track of offline peers like that, this is something that could be done client-side.\r\n\r\nI want to point out that this stable peer list feature also opens up an avenue for a DoS attack that should somehow be addressed. A malicious user could keep rejoining the same group with new group identity, increasing the peer list of everyone in the group chat. This might be less of an issue for an actively moderated group chat, but if the moderators are often afk, someone creating thousands of new peers per second might pose an issue. Even if the moderators in the same timezone and are asleep for 8 hours, that might still pose an issue. The peer list is stored in the RAM as toxcore doesn't do disk storage, so all the attacker would need to do is to create enough peers to make toxcore + the client consume all the available RAM. One way around that would be setting a limit on the number of offline peers toxcore remembers per a group chat to some reasonable amount, allowing the client to change that limit via API.",
            "created_at": "2024-03-02T23:29:14Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2721#issuecomment-1974940272",
            "id": 1974940272,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721",
            "node_id": "IC_kwDOA7zIGs51tzJw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1974940272/reactions"
            },
            "updated_at": "2024-03-03T11:26:33Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1974940272",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1855294?v=4",
                "events_url": "https://api.github.com/users/nurupo/events{/privacy}",
                "followers_url": "https://api.github.com/users/nurupo/followers",
                "following_url": "https://api.github.com/users/nurupo/following{/other_user}",
                "gists_url": "https://api.github.com/users/nurupo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nurupo",
                "id": 1855294,
                "login": "nurupo",
                "node_id": "MDQ6VXNlcjE4NTUyOTQ=",
                "organizations_url": "https://api.github.com/users/nurupo/orgs",
                "received_events_url": "https://api.github.com/users/nurupo/received_events",
                "repos_url": "https://api.github.com/users/nurupo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nurupo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nurupo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nurupo"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "NGC groups are limited to 100 peers per default. saved peers are also limited in NGC.\r\nand PGC has this offline peer limit aswell.\r\n\r\n```\r\n#define MAX_GC_PEERS_DEFAULT 100\r\n#define GC_MAX_SAVED_PEERS 100\r\n```\r\n\r\ni get the rest of your concerns though.\r\n\r\n\r\ni still think it is expected of a messenger today to have this. apart from IRC i don't think i know any messenger which lacks a stable peerlist.\r\n\r\nhow does PGC keep a stable peer list? does it not? i am not 100% sure how it works in PGC, it appears like a stable synchronized peers list though.\r\n\r\nthere are a few (random) examples where it helps to have all peers known in a group:\r\n\r\n* you are invited to a private group, and when you join you can only see the peers currently online. you have no idea who else is in the group. when you type a message and hit send, at that very moment 3 peers can come online and read your message. you did not expect those 3 people to read your message since you did not even know that they were already members of the group\r\n\r\n* if a peer enters a group, then posts SPAM, then leaves quickly. there is no way to mute that peer. since you can only demote a peer when that peer is online. (this scenario has actually happend a few times already). now you need a bot again to wait until this peer comes online to mute him for the entire group. with a synced peer list actions like demoting could be implemented for offline peers aswell.\r\n\r\n\r\n",
            "created_at": "2024-03-03T08:33:52Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2721#issuecomment-1975086701",
            "id": 1975086701,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721",
            "node_id": "IC_kwDOA7zIGs51uW5t",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1975086701/reactions"
            },
            "updated_at": "2024-03-03T08:43:24Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1975086701",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6833516?v=4",
                "events_url": "https://api.github.com/users/zoff99/events{/privacy}",
                "followers_url": "https://api.github.com/users/zoff99/followers",
                "following_url": "https://api.github.com/users/zoff99/following{/other_user}",
                "gists_url": "https://api.github.com/users/zoff99/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zoff99",
                "id": 6833516,
                "login": "zoff99",
                "node_id": "MDQ6VXNlcjY4MzM1MTY=",
                "organizations_url": "https://api.github.com/users/zoff99/orgs",
                "received_events_url": "https://api.github.com/users/zoff99/received_events",
                "repos_url": "https://api.github.com/users/zoff99/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zoff99/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zoff99/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zoff99"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Good to know, didn't know NGC had these limits.\r\n\r\n>when you type a message and hit send, at that very moment 3 peers can come online and read your message. you did not expect those 3 people to read your message since you did not even know that they were already members of the group\r\n\r\nRight, but how is it different from someone joining the group for the first time a moment before you send your message? Your message would be read by people whom you didn't expect to be in the group chat and no stable peer list would save you from new peers joining. That's not a strong argument for a stable peer list.\r\n\r\n>if a peer enters a group, then posts SPAM, then leaves quickly. there is no way to mute that peer. since you can only demote a peer when that peer is online. (this scenario has actually happend a few times already). now you need a bot again to wait until this peer comes online to mute him for the entire group. with a synced peer list actions like demoting could be implemented for offline peers aswell.\r\n\r\nThat sounds like something separate from the stable peer list feature. A separate feature requests for NGC to allow sanctioning arbitrary public keys, such that moderators could mute/ban/whatever a peer even if there is no such peer in the group chat.\r\n\r\n(While on this topic, I'm surprised NGC doesn't allow blocking of exact IP addresses and IP ranges/subnets, as public key based blocking is rather easy to circumvent. I guess this is hard to do when peer A might be connected directly to peer B, but via a TCP relay to peer C, so B and C see different IP addresses and both would need to get blocked, and blocking TCP relays is kind of bad as other currently online peers might be using it or an offline peer / new gc member might join via it and get unintentionally blocked?).",
            "created_at": "2024-03-03T12:23:03Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2721#issuecomment-1975143003",
            "id": 1975143003,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721",
            "node_id": "IC_kwDOA7zIGs51ukpb",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1975143003/reactions"
            },
            "updated_at": "2024-03-03T12:23:03Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1975143003",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1855294?v=4",
                "events_url": "https://api.github.com/users/nurupo/events{/privacy}",
                "followers_url": "https://api.github.com/users/nurupo/followers",
                "following_url": "https://api.github.com/users/nurupo/following{/other_user}",
                "gists_url": "https://api.github.com/users/nurupo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nurupo",
                "id": 1855294,
                "login": "nurupo",
                "node_id": "MDQ6VXNlcjE4NTUyOTQ=",
                "organizations_url": "https://api.github.com/users/nurupo/orgs",
                "received_events_url": "https://api.github.com/users/nurupo/received_events",
                "repos_url": "https://api.github.com/users/nurupo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nurupo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nurupo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nurupo"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">  but if the moderators are often afk, someone creating thousands of new peers per second might pose an issue.\r\n\r\nNGC rate limits new peer handshakes, so while this would still be an issue, you could do maybe a few dozen per minute rather than thousands per second.\r\n\r\n> While on this topic, I'm surprised NGC doesn't allow blocking of exact IP addresses and IP ranges/subnets, as public key based blocking is rather easy to circumvent. I guess this is hard to do when peer A might be connected directly to peer B, but via a TCP relay to peer C, so B and C see different IP addresses and both would need to get blocked, and blocking TCP relays is kind of bad as other currently online peers might be using it or an offline peer / new gc member might join via it and get unintentionally blocked?.\r\n\r\nWe used to have IP bans but decided to remove that feature because it was effectively useless with the existence of TCP relays. Anyone running tox with UDP disabled would be able to circumvent the block. \r\n",
            "created_at": "2024-03-03T14:42:42Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2721#issuecomment-1975185161",
            "id": 1975185161,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721",
            "node_id": "IC_kwDOA7zIGs51uu8J",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1975185161/reactions"
            },
            "updated_at": "2024-03-03T14:42:42Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1975185161",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721/comments",
    "created_at": "2024-03-02T08:06:46Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6833516?v=4",
                "events_url": "https://api.github.com/users/zoff99/events{/privacy}",
                "followers_url": "https://api.github.com/users/zoff99/followers",
                "following_url": "https://api.github.com/users/zoff99/following{/other_user}",
                "gists_url": "https://api.github.com/users/zoff99/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zoff99",
                "id": 6833516,
                "login": "zoff99",
                "node_id": "MDQ6VXNlcjY4MzM1MTY=",
                "organizations_url": "https://api.github.com/users/zoff99/orgs",
                "received_events_url": "https://api.github.com/users/zoff99/received_events",
                "repos_url": "https://api.github.com/users/zoff99/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zoff99/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zoff99/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zoff99"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-03-02T08:07:49Z",
            "event": "labeled",
            "id": 11986823461,
            "label": {
                "color": "ee0701",
                "name": "bug"
            },
            "node_id": "LE_lADOA7zIGs6BBpv9zwAAAALKeGkl",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11986823461"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6833516?v=4",
                "events_url": "https://api.github.com/users/zoff99/events{/privacy}",
                "followers_url": "https://api.github.com/users/zoff99/followers",
                "following_url": "https://api.github.com/users/zoff99/following{/other_user}",
                "gists_url": "https://api.github.com/users/zoff99/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zoff99",
                "id": 6833516,
                "login": "zoff99",
                "node_id": "MDQ6VXNlcjY4MzM1MTY=",
                "organizations_url": "https://api.github.com/users/zoff99/orgs",
                "received_events_url": "https://api.github.com/users/zoff99/received_events",
                "repos_url": "https://api.github.com/users/zoff99/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zoff99/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zoff99/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zoff99"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-03-02T08:07:49Z",
            "event": "labeled",
            "id": 11986823464,
            "label": {
                "color": "84b6eb",
                "name": "enhancement"
            },
            "node_id": "LE_lADOA7zIGs6BBpv9zwAAAALKeGko",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11986823464"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-03-02T13:29:05Z",
            "event": "unlabeled",
            "id": 11987397394,
            "label": {
                "color": "ee0701",
                "name": "bug"
            },
            "node_id": "UNLE_lADOA7zIGs6BBpv9zwAAAALKgSsS",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11987397394"
        }
    ],
    "events_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721/events",
    "html_url": "https://github.com/TokTok/c-toxcore/issues/2721",
    "id": 2164694013,
    "labels": [
        {
            "color": "84b6eb",
            "default": true,
            "description": "New feature for the user, not a new feature for build script",
            "id": 403702218,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw0MDM3MDIyMTg=",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/labels/enhancement"
        }
    ],
    "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOA7zIGs6BBpv9",
    "number": 2721,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721/reactions"
    },
    "repository_url": "https://api.github.com/repos/TokTok/c-toxcore",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721/timeline",
    "title": "NGC: provide a stable peer list for NGC groups",
    "updated_at": "2024-03-03T14:42:43Z",
    "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2721",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6833516?v=4",
        "events_url": "https://api.github.com/users/zoff99/events{/privacy}",
        "followers_url": "https://api.github.com/users/zoff99/followers",
        "following_url": "https://api.github.com/users/zoff99/following{/other_user}",
        "gists_url": "https://api.github.com/users/zoff99/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zoff99",
        "id": 6833516,
        "login": "zoff99",
        "node_id": "MDQ6VXNlcjY4MzM1MTY=",
        "organizations_url": "https://api.github.com/users/zoff99/orgs",
        "received_events_url": "https://api.github.com/users/zoff99/received_events",
        "repos_url": "https://api.github.com/users/zoff99/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zoff99/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zoff99/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zoff99"
    }
}