{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "Toxcore made the choice of not requiring a packet id system in the api for custom packets.\r\nhttps://github.com/TokTok/c-toxcore/blob/9592d590cf4b4bad9117d9df618c7bab351cb70f/toxcore/tox.h#L4744-L4771\r\n\r\nAs such, here are a couple of possibilities, ideally one of which we choose to be THE ONLY way. There are however implicit compatibilities between different options.\r\n\r\n## static packet ids\r\n\r\n### integer packet id\r\n\r\n#### A0 - 16bit fixed integer\r\nEvery packet is prefixed with a 16bit integer packet id. This allows for a total of 65536 possibilities.\r\nThis also allows specify subranges for individual use and tox-offical \"spec\", like eg the first `1024` ids or more.\r\n\r\n#### A1 and A2 - 24bit and 32bit fixed integer\r\nLike option A0, but larger number space that is very unlikely to ever be exhausted/needed.\r\n\r\n### dual integer packet id\r\n\r\n#### B0 - 8/16bit switched integer\r\nHere we let the first bit decide whether the id is 8bit or 16bit (effectively 7bit and 15bit ranges). This allows for us to save an extra byte for packet types we deem profiting from this. eg. filetransfers will send a lot of `data` and `ack` type packets that can collectively waste bytes in the gigabytes ranges or more each year. Since the first bit is the switch, this only allows for `128` different ids, so they would be rare. It also cuts the larger id into `32768` possibilities. Which is probably still sufficient. Individually the ranges act similar to option A0 (and A1 and A2).\r\n\r\n#### B1 and B2 - 8/24bit and 8/32bit switched integer\r\nLike option B0, but larger second range. (also see option A1 and A2)\r\n\r\n### large integer packet id with namespace subdivision(s)\r\n\r\n#### C0 - 64bit (48bit namespace + 8bit packet id + 8bit packet version)\r\nThis is conceptually like options A0, A1 and A2, but assignes different bytes different meanings.\r\nThe first `6` bytes are used as a user/org specific `namespace` (aka magic), the next byte specifies the `packet id` and the last byte a `packet version`, for future compatibility checks.\r\nThe advantage here is the clear separation between individuals and protocol changes.\r\nThe disadvantage is the size, 64bit just to identify a packet type seems excessive.\r\n\r\n#### C1 - 32bit (16bit namespace + 8bit packet id + 8bit packet version)\r\nSame as option C0 but with a more reasonable `namespace` size. Still pretty large.\r\n\r\n#### C2 - 24bit (12bit namespace + 12bit packet id)\r\nSame as option C0 but with an even smaller `namespace` (`4096`) and smaller and combined `packet id` + `packet version space` (`4096`). The `packet id` and `version` amalgamation also means less space is wasted for the unlikely case of version filling the full `256` possibilities.\r\n\r\n#### C3 - 8/24bit and 8/32bit switched namespaced integer\r\nThis is a combination of options B0 (B1, B2) and C2/C1. Where the 8bit(7bit) numbers are tox-official `small packet id` designated and the larger variant is option C2 or C1 with some bits moved around (either namespace or packet id(/version) has 1bit less).\r\n\r\n## dynamic packet ids\r\n\r\n### initial mapping announce\r\n\r\n#### D0 - full packet id mapping exchanged at/after connection / before use\r\nHere we exchange all the custom packets we understand and which `ephemeral packet id` to prefix each packet with. This might take multiple `mapping announce` packets. Then the other side knows which `ephemeral id` they should use to make data be treated as a certain `packet type`. Each `packet type` will be specified by a 64bit `UUID` (parts of which is a namespace). If a `mapping announce packet` is not `ACK`ed, we resend the packet up to 3 times after each timeout.\r\nThe mapping of a `UUID` to a `ephemeral id` is static, once announced. Later `mapping announces` can still add new mappings.\r\n\r\nTODO: more variations of D0 ?\r\n\r\n#### E0 - toxext (modified)\r\nsee https://github.com/toxext/toxext/blob/master/DESIGN.md\r\nWith toxext, one sides sends `UUID` + `MY_IDENTIFIER` and the other side replies with `YOUR_IDENTIFIER`.\r\nThe `toxext magic` will not be necessary, since we will designate every other use as off-spec.\r\n\r\n\r\n---\r\nIf you have ideas for more variants, please let me know so I can add them to the list :mailbox_with_mail: .\r\nAt some point we will have to discuss it more and settle on one of the options :speaking_head: .\r\nTimeline for this is to be settled on one of the options by the time v0.2.19 released (so very soon).",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "dont forget to establish a package registry ala https://github.com/zoff99/toxcore_custom_packets_registry",
            "created_at": "2024-01-11T14:17:39Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2544#issuecomment-1887269460",
            "id": 1887269460,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544",
            "node_id": "IC_kwDOA7zIGs5wfXJU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887269460/reactions"
            },
            "updated_at": "2024-01-11T14:17:39Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887269460",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6833516?v=4",
                "events_url": "https://api.github.com/users/zoff99/events{/privacy}",
                "followers_url": "https://api.github.com/users/zoff99/followers",
                "following_url": "https://api.github.com/users/zoff99/following{/other_user}",
                "gists_url": "https://api.github.com/users/zoff99/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zoff99",
                "id": 6833516,
                "login": "zoff99",
                "node_id": "MDQ6VXNlcjY4MzM1MTY=",
                "organizations_url": "https://api.github.com/users/zoff99/orgs",
                "received_events_url": "https://api.github.com/users/zoff99/received_events",
                "repos_url": "https://api.github.com/users/zoff99/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zoff99/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zoff99/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zoff99"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "also i am using packages with these magic first 6 bytes already: 0x667788113435\r\nso mark those as \"already registered\" please.\r\ndepending on how many bytes it will be: 0x6677 if it will be the first 2",
            "created_at": "2024-01-11T14:19:20Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2544#issuecomment-1887275452",
            "id": 1887275452,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544",
            "node_id": "IC_kwDOA7zIGs5wfYm8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887275452/reactions"
            },
            "updated_at": "2024-01-11T14:19:59Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887275452",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6833516?v=4",
                "events_url": "https://api.github.com/users/zoff99/events{/privacy}",
                "followers_url": "https://api.github.com/users/zoff99/followers",
                "following_url": "https://api.github.com/users/zoff99/following{/other_user}",
                "gists_url": "https://api.github.com/users/zoff99/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zoff99",
                "id": 6833516,
                "login": "zoff99",
                "node_id": "MDQ6VXNlcjY4MzM1MTY=",
                "organizations_url": "https://api.github.com/users/zoff99/orgs",
                "received_events_url": "https://api.github.com/users/zoff99/received_events",
                "repos_url": "https://api.github.com/users/zoff99/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zoff99/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zoff99/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zoff99"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> also i am using packages with these magic first 6 bytes already: 0x667788113435 so mark those as \"already registered\" please. depending on how many bytes it will be: 0x6677 if it will be the first 2\r\n\r\nyep, was my plan.\r\n\r\n> dont forget to establish a package registry ala https://github.com/zoff99/toxcore_custom_packets_registry\r\n\r\nwill do once we settle on the packet id type.",
            "created_at": "2024-01-11T14:40:25Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2544#issuecomment-1887327695",
            "id": 1887327695,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544",
            "node_id": "IC_kwDOA7zIGs5wflXP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887327695/reactions"
            },
            "updated_at": "2024-01-11T14:40:57Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887327695",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544/comments",
    "created_at": "2024-01-11T11:54:43Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-11T12:06:11Z",
            "event": "milestoned",
            "id": 11455669403,
            "milestone": {
                "title": "v0.2.19"
            },
            "node_id": "MIE_lADOA7zIGs57w6SIzwAAAAKqz6Sb",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11455669403"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-11T16:17:58Z",
            "event": "demilestoned",
            "id": 11767481691,
            "milestone": {
                "title": "v0.2.19"
            },
            "node_id": "DEME_lADOA7zIGs57w6SIzwAAAAK9ZYVb",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11767481691"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-11T16:17:58Z",
            "event": "milestoned",
            "id": 11767481693,
            "milestone": {
                "title": "v0.2.20"
            },
            "node_id": "MIE_lADOA7zIGs57w6SIzwAAAAK9ZYVd",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11767481693"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-13T00:37:32Z",
            "event": "demilestoned",
            "id": 11781533509,
            "milestone": {
                "title": "v0.2.20"
            },
            "node_id": "DEME_lADOA7zIGs57w6SIzwAAAAK-O-9F",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11781533509"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-13T00:37:32Z",
            "event": "milestoned",
            "id": 11781533518,
            "milestone": {
                "title": "v0.2.x"
            },
            "node_id": "MIE_lADOA7zIGs57w6SIzwAAAAK-O-9O",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11781533518"
        }
    ],
    "events_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544/events",
    "html_url": "https://github.com/TokTok/c-toxcore/issues/2544",
    "id": 2076419208,
    "labels": [],
    "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 0,
        "created_at": "2018-03-09T13:13:48Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
            "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
            "followers_url": "https://api.github.com/users/iphydf/followers",
            "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
            "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/iphydf",
            "id": 10647936,
            "login": "iphydf",
            "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
            "organizations_url": "https://api.github.com/users/iphydf/orgs",
            "received_events_url": "https://api.github.com/users/iphydf/received_events",
            "repos_url": "https://api.github.com/users/iphydf/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/iphydf"
        },
        "description": "Placeholder for the next 0.2.x version.",
        "due_on": null,
        "html_url": "https://github.com/TokTok/c-toxcore/milestone/28",
        "id": 3174131,
        "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/28/labels",
        "node_id": "MDk6TWlsZXN0b25lMzE3NDEzMQ==",
        "number": 28,
        "open_issues": 124,
        "state": "open",
        "title": "v0.2.x",
        "updated_at": "2024-02-21T10:27:33Z",
        "url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/28"
    },
    "node_id": "I_kwDOA7zIGs57w6SI",
    "number": 2544,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544/reactions"
    },
    "repository_url": "https://api.github.com/repos/TokTok/c-toxcore",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544/timeline",
    "title": "RFC: Custom Packet differenciation (aka packet ids) for NGC",
    "updated_at": "2024-02-13T00:37:32Z",
    "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2544",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
        "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
        "followers_url": "https://api.github.com/users/Green-Sky/followers",
        "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
        "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Green-Sky",
        "id": 2938071,
        "login": "Green-Sky",
        "node_id": "MDQ6VXNlcjI5MzgwNzE=",
        "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
        "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
        "repos_url": "https://api.github.com/users/Green-Sky/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Green-Sky"
    }
}