{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/TokTok/toxic/issues/63/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/TokTok/toxic/pulls/63/commits"
        },
        "html": {
            "href": "https://github.com/TokTok/toxic/pull/63"
        },
        "issue": {
            "href": "https://api.github.com/repos/TokTok/toxic/issues/63"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/TokTok/toxic/pulls/63/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
        },
        "statuses": {
            "href": "https://api.github.com/repos/TokTok/toxic/statuses/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142"
        }
    },
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
        "events_url": "https://api.github.com/users/zugz/events{/privacy}",
        "followers_url": "https://api.github.com/users/zugz/followers",
        "following_url": "https://api.github.com/users/zugz/following{/other_user}",
        "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zugz",
        "id": 590069,
        "login": "zugz",
        "node_id": "MDQ6VXNlcjU5MDA2OQ==",
        "organizations_url": "https://api.github.com/users/zugz/orgs",
        "received_events_url": "https://api.github.com/users/zugz/received_events",
        "repos_url": "https://api.github.com/users/zugz/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zugz"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
            "events_url": "https://api.github.com/users/zugz/events{/privacy}",
            "followers_url": "https://api.github.com/users/zugz/followers",
            "following_url": "https://api.github.com/users/zugz/following{/other_user}",
            "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zugz",
            "id": 590069,
            "login": "zugz",
            "node_id": "MDQ6VXNlcjU5MDA2OQ==",
            "organizations_url": "https://api.github.com/users/zugz/orgs",
            "received_events_url": "https://api.github.com/users/zugz/received_events",
            "repos_url": "https://api.github.com/users/zugz/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zugz"
        }
    ],
    "author_association": "MEMBER",
    "auto_merge": null,
    "base": {
        "label": "TokTok:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/TokTok/toxic/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/TokTok/toxic/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/TokTok/toxic/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/TokTok/toxic/branches{/branch}",
            "clone_url": "https://github.com/TokTok/toxic.git",
            "collaborators_url": "https://api.github.com/repos/TokTok/toxic/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/TokTok/toxic/comments{/number}",
            "commits_url": "https://api.github.com/repos/TokTok/toxic/commits{/sha}",
            "compare_url": "https://api.github.com/repos/TokTok/toxic/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/TokTok/toxic/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/TokTok/toxic/contributors",
            "created_at": "2018-01-20T18:29:55Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/TokTok/toxic/deployments",
            "description": "An ncurses-based Tox client",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/TokTok/toxic/downloads",
            "events_url": "https://api.github.com/repos/TokTok/toxic/events",
            "fork": true,
            "forks": 4,
            "forks_count": 4,
            "forks_url": "https://api.github.com/repos/TokTok/toxic/forks",
            "full_name": "TokTok/toxic",
            "git_commits_url": "https://api.github.com/repos/TokTok/toxic/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/TokTok/toxic/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/TokTok/toxic/git/tags{/sha}",
            "git_url": "git://github.com/TokTok/toxic.git",
            "has_discussions": false,
            "has_downloads": false,
            "has_issues": true,
            "has_pages": false,
            "has_projects": false,
            "has_wiki": false,
            "homepage": "https://toktok.ltd/",
            "hooks_url": "https://api.github.com/repos/TokTok/toxic/hooks",
            "html_url": "https://github.com/TokTok/toxic",
            "id": 118269669,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/TokTok/toxic/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/TokTok/toxic/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/TokTok/toxic/issues{/number}",
            "keys_url": "https://api.github.com/repos/TokTok/toxic/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/TokTok/toxic/labels{/name}",
            "language": "C",
            "languages_url": "https://api.github.com/repos/TokTok/toxic/languages",
            "license": {
                "key": "gpl-3.0",
                "name": "GNU General Public License v3.0",
                "node_id": "MDc6TGljZW5zZTk=",
                "spdx_id": "GPL-3.0",
                "url": "https://api.github.com/licenses/gpl-3.0"
            },
            "merges_url": "https://api.github.com/repos/TokTok/toxic/merges",
            "milestones_url": "https://api.github.com/repos/TokTok/toxic/milestones{/number}",
            "mirror_url": null,
            "name": "toxic",
            "node_id": "MDEwOlJlcG9zaXRvcnkxMTgyNjk2Njk=",
            "notifications_url": "https://api.github.com/repos/TokTok/toxic/notifications{?since,all,participating}",
            "open_issues": 11,
            "open_issues_count": 11,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/17427091?v=4",
                "events_url": "https://api.github.com/users/TokTok/events{/privacy}",
                "followers_url": "https://api.github.com/users/TokTok/followers",
                "following_url": "https://api.github.com/users/TokTok/following{/other_user}",
                "gists_url": "https://api.github.com/users/TokTok/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TokTok",
                "id": 17427091,
                "login": "TokTok",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjE3NDI3MDkx",
                "organizations_url": "https://api.github.com/users/TokTok/orgs",
                "received_events_url": "https://api.github.com/users/TokTok/received_events",
                "repos_url": "https://api.github.com/users/TokTok/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TokTok/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TokTok/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/TokTok"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/TokTok/toxic/pulls{/number}",
            "pushed_at": "2024-02-23T19:03:01Z",
            "releases_url": "https://api.github.com/repos/TokTok/toxic/releases{/id}",
            "size": 18192,
            "ssh_url": "git@github.com:TokTok/toxic.git",
            "stargazers_count": 27,
            "stargazers_url": "https://api.github.com/repos/TokTok/toxic/stargazers",
            "statuses_url": "https://api.github.com/repos/TokTok/toxic/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/TokTok/toxic/subscribers",
            "subscription_url": "https://api.github.com/repos/TokTok/toxic/subscription",
            "svn_url": "https://github.com/TokTok/toxic",
            "tags_url": "https://api.github.com/repos/TokTok/toxic/tags",
            "teams_url": "https://api.github.com/repos/TokTok/toxic/teams",
            "topics": [
                "chat",
                "console",
                "tox"
            ],
            "trees_url": "https://api.github.com/repos/TokTok/toxic/git/trees{/sha}",
            "updated_at": "2024-01-26T11:24:24Z",
            "url": "https://api.github.com/repos/TokTok/toxic",
            "visibility": "public",
            "watchers": 27,
            "watchers_count": 27,
            "web_commit_signoff_required": false
        },
        "sha": "dac0124f0f620b288ac8739775c1716b5777fea0",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/17427091?v=4",
            "events_url": "https://api.github.com/users/TokTok/events{/privacy}",
            "followers_url": "https://api.github.com/users/TokTok/followers",
            "following_url": "https://api.github.com/users/TokTok/following{/other_user}",
            "gists_url": "https://api.github.com/users/TokTok/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/TokTok",
            "id": 17427091,
            "login": "TokTok",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjE3NDI3MDkx",
            "organizations_url": "https://api.github.com/users/TokTok/orgs",
            "received_events_url": "https://api.github.com/users/TokTok/received_events",
            "repos_url": "https://api.github.com/users/TokTok/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/TokTok/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TokTok/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/TokTok"
        }
    },
    "body": "Per-friend call state;\nvideo call control fixed in various ways;\nnew /vcall command to initiate video calls.\n\n<!-- Reviewable:start -->\n---\nThis change is [<img src=\"https://reviewable.io/review_button.svg\" height=\"34\" align=\"absmiddle\" alt=\"Reviewable\"/>](https://reviewable.io/reviews/toktok/toxic/63)\n<!-- Reviewable:end -->\n",
    "closed_at": "2020-11-14T18:35:14Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410509345"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410509345"
                }
            },
            "author_association": "MEMBER",
            "body": "This can go into the for-loop.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-17T23:09:08Z",
            "diff_hunk": "@@ -183,94 +146,156 @@ void read_device_callback(const int16_t *captured, uint32_t size, void *data)\n     int64_t sample_count = ((int64_t) CallControl.audio_sample_rate) * \\\n                            ((int64_t) CallControl.audio_frame_duration) / 1000;\n \n-    if (sample_count <= 0 || toxav_audio_send_frame(CallControl.av, friend_number,\n-            captured, sample_count,\n-            CallControl.audio_channels,\n-            CallControl.audio_sample_rate, &error) == false) {\n+    if (sample_count <= 0) {\n+        return;\n     }\n+\n+    toxav_audio_send_frame(CallControl.av, friend_number,\n+                           captured, sample_count,\n+                           CallControl.audio_channels,\n+                           CallControl.audio_sample_rate, &error);\n }\n \n void write_device_callback(uint32_t friend_number, const int16_t *PCM, uint16_t sample_count, uint8_t channels,\n                            uint32_t sample_rate)\n {\n-    if (CallControl.calls[friend_number].ttas) {\n+    if (CallControl.calls[friend_number].status == cs_Active) {\n         write_out(CallControl.calls[friend_number].out_idx, PCM, sample_count, channels, sample_rate);\n     }\n }\n \n-int start_transmission(ToxWindow *self, Call *call)\n+bool init_call(Call *call)\n {\n-    if (!self || !CallControl.av) {\n-        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to prepare transmission\");\n-        return -1;\n+    if (call->status != cs_None) {\n+        return false;\n+    }\n+\n+    memset(call, 0, sizeof(Call));\n+\n+    call->status = cs_Pending;\n+\n+    call->in_idx = -1;\n+    call->out_idx = -1;\n+    call->audio_bit_rate = CallControl.default_audio_bit_rate;\n+#ifdef VIDEO\n+    call->vin_idx = -1;\n+    call->vout_idx = -1;\n+    call->video_width = CallControl.default_video_width;\n+    call->video_height = CallControl.default_video_height;\n+    call->video_bit_rate = CallControl.default_video_bit_rate;\n+#endif /* VIDEO */\n+\n+    return true;\n+}\n+\n+static bool cancel_call(Call *call)\n+{\n+    if (call->status != cs_Pending) {\n+        return false;\n     }\n \n-    if (set_call(call, true) == -1) {\n+    call->status = cs_None;\n+\n+    return true;\n+}\n+\n+static int start_transmission(ToxWindow *self, Call *call)\n+{\n+    if (!self || !CallControl.av) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to prepare audio transmission\");\n         return -1;\n     }\n \n-    DeviceError error = open_primary_device(input, &call->in_idx,\n-                                            CallControl.audio_sample_rate, CallControl.audio_frame_duration, CallControl.audio_channels);\n+    DeviceError error = open_input_device(&call->in_idx, read_device_callback, &self->num, false,\n+                                          CallControl.audio_sample_rate, CallControl.audio_frame_duration, CallControl.audio_channels);\n \n     if (error != de_None) {\n         if (error == de_FailedStart) {\n-            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to start input device\");\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to start audio input device\");\n         }\n \n         if (error == de_InternalError) {\n-            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Internal error with opening input device\");\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Internal error with opening audio input device\");\n         }\n     }\n \n-    if (register_device_callback(self->num, call->in_idx,\n-                                 read_device_callback, &self->num, true) != de_None)\n-        /* Set VAD as true for all; TODO: Make it more dynamic */\n-    {\n-        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to register input handler!\");\n+    if (open_output_device(&call->out_idx,\n+                           CallControl.audio_sample_rate, CallControl.audio_frame_duration, CallControl.audio_channels) != de_None) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to open audio output device!\");\n     }\n \n-    if (open_primary_device(output, &call->out_idx,\n-                            CallControl.audio_sample_rate, CallControl.audio_frame_duration, CallControl.audio_channels) != de_None) {\n-        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Failed to open output device!\");\n-        call->has_output = 0;\n+    return 0;\n+}\n+\n+static void start_call(ToxWindow *self, Call *call)\n+{\n+    if (call->status != cs_Pending) {\n+        return;\n     }\n \n-    return 0;\n+    if (start_transmission(self, call) != 0) {\n+        return;\n+    }\n+\n+    call->status = cs_Active;\n+\n+#ifdef VIDEO\n+\n+    if (call->state & TOXAV_FRIEND_CALL_STATE_SENDING_V) {\n+        callback_recv_video_starting(self->num);\n+    }\n+\n+    if (call->video_bit_rate) {\n+        start_video_transmission(self, CallControl.av, call);\n+    }\n+\n+#endif\n }\n \n-int stop_transmission(Call *call, uint32_t friend_number)\n+static int stop_transmission(Call *call, uint32_t friend_number)\n {\n-    if (call->ttas) {\n-        Toxav_Err_Call_Control error = TOXAV_ERR_CALL_CONTROL_OK;\n+    if (call->status != cs_Active) {\n+        return -1;\n+    }\n \n-        if (CallControl.call_state > TOXAV_FRIEND_CALL_STATE_FINISHED) {\n-            toxav_call_control(CallControl.av, friend_number, TOXAV_CALL_CONTROL_CANCEL, &error);\n-        }\n+    call->status = cs_None;\n \n-        if (error == TOXAV_ERR_CALL_CONTROL_OK) {\n-            call->ttas = false;\n+    if (call->in_idx != -1) {\n+        close_device(input, call->in_idx);\n+    }\n \n-            if (call->in_idx != -1) {\n-                close_device(input, call->in_idx);\n-            }\n+    if (call->out_idx != -1) {\n+        close_device(output, call->out_idx);\n+    }\n \n-            if (call->out_idx != -1) {\n-                close_device(output, call->out_idx);\n-            }\n+    Toxav_Err_Call_Control error = TOXAV_ERR_CALL_CONTROL_OK;\n \n-            if (set_call(call, false) == -1) {\n-                return -1;\n-            }\n+    if (call->state > TOXAV_FRIEND_CALL_STATE_FINISHED) {\n+        toxav_call_control(CallControl.av, friend_number, TOXAV_CALL_CONTROL_CANCEL, &error);\n+    }\n \n-            return 0;\n-        } else {\n+    if (error != TOXAV_ERR_CALL_CONTROL_OK) {\n+        return -1;\n+    }\n \n-            return -1;\n-        }\n+    return 0;\n+}\n+\n+void terminate_audio(void)\n+{\n+    int i;",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410509345",
            "id": 410509345,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUwOTM0NQ==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 286,
            "original_position": 284,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395819629,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410509345/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410509345",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410513367"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410513367"
                }
            },
            "author_association": "MEMBER",
            "body": "No need for extra parens.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-17T23:27:26Z",
            "diff_hunk": "@@ -298,60 +334,53 @@ void on_call_state(ToxAV *av, uint32_t friend_number, uint32_t state, void *user\n     UNUSED_VAR(av);\n     UNUSED_VAR(user_data);\n \n-    CallControl.call_state = state;\n+    Call *call = &CallControl.calls[friend_number];\n \n-    switch (state) {\n-        case (TOXAV_FRIEND_CALL_STATE_ERROR):\n-            line_info_add(CallControl.prompt, NULL, NULL, NULL, SYS_MSG, 0, 0, \"ToxAV callstate error!\");\n-\n-#ifdef VIDEO\n-            callback_video_end(friend_number);\n-#endif /* VIDEO */\n-\n-            stop_transmission(&CallControl.calls[friend_number], friend_number);\n-            callback_call_ended(friend_number);\n-            CallControl.pending_call = false;\n+    if (call->status == cs_None) {\n+        return;\n+    }\n \n-            break;\n+    call->state = state;\n \n+    switch (state) {\n+        case (TOXAV_FRIEND_CALL_STATE_ERROR):",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410513367",
            "id": 410513367,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUxMzM2Nw==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 346,
            "original_position": 353,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395819629,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410513367/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410513367",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410519746"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410519746"
                }
            },
            "author_association": "MEMBER",
            "body": "Sort includes.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T00:00:21Z",
            "diff_hunk": "@@ -21,12 +21,19 @@\n  */\n \n #include <string.h>\n+#include <stdlib.h>",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410519746",
            "id": 410519746,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUxOTc0Ng==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 23,
            "original_position": 4,
            "original_start_line": null,
            "path": "src/group_commands.c",
            "position": null,
            "pull_request_review_id": 395819629,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410519746/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410519746",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410527474"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410527474"
                }
            },
            "author_association": "MEMBER",
            "body": "These can both be const.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T00:50:08Z",
            "diff_hunk": "@@ -359,25 +472,99 @@ static int realloc_peer_list(GroupChat *chat, uint32_t num_peers)\n     return 0;\n }\n \n-static void update_peer_list(Tox *m, uint32_t groupnum, uint32_t num_peers)\n+#ifdef AUDIO\n+static void set_peer_audio_position(Tox *m, uint32_t groupnum, uint32_t peernum)\n+{\n+    GroupChat *chat = &groupchats[groupnum];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410527474",
            "id": 410527474,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUyNzQ3NA==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 478,
            "original_position": 231,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395819629,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410527474/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410527474",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410689412"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689412"
                }
            },
            "author_association": "MEMBER",
            "body": "Given that `CallControl.calls[friend_number]` is invariant, you could hoist it out of the loop here and in all other similar loops below.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:06:54Z",
            "diff_hunk": "@@ -389,74 +421,67 @@ void callback_recv_invite(Tox *m, uint32_t friend_number)\n \n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onInvite != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onInvite(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onInvite(windows[i], CallControl.av, friend_number, CallControl.calls[friend_number].state);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410689412",
            "id": 410689412,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY4OTQxMg==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 422,
            "original_position": 436,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689412/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689412",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410689546"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689546"
                }
            },
            "author_association": "MEMBER",
            "body": "I'd use `Call *call = &Cal...` here like in other places.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:08:27Z",
            "diff_hunk": "@@ -901,8 +823,8 @@ void cmd_sense(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[M\n     }\n \n     /* Call must be active */\n-    if (self->is_call) {\n-        device_set_VAD_treshold(CallControl.calls[self->num].in_idx, value);\n+    if (CallControl.calls[self->num].status == cs_Active) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410689546",
            "id": 410689546,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY4OTU0Ng==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 824,
            "original_position": 777,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689546/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689546",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410689713"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689713"
                }
            },
            "author_association": "MEMBER",
            "body": "Can you make all of these `Call *const call = &...`? That way we don't need to consider that it may be reassigned later in the function and have a different meaning there.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:09:53Z",
            "diff_hunk": "@@ -919,25 +841,39 @@ void cmd_bitrate(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)\n \n     char *error_str;\n \n-    if (argc != 1) {\n-        error_str = \"Must have value!\";\n+    Call *call = &CallControl.calls[self->num];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410689713",
            "id": 410689713,
            "line": 809,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY4OTcxMw==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 809,
            "original_position": 788,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 1067,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689713/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410689713",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690026"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690026"
                }
            },
            "author_association": "MEMBER",
            "body": "We may also want to avoid the bit rate exceeding UINT32_MAX (although this will give a warning if you compile for ILP32).",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:13:08Z",
            "diff_hunk": "@@ -919,25 +841,39 @@ void cmd_bitrate(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)\n \n     char *error_str;\n \n-    if (argc != 1) {\n-        error_str = \"Must have value!\";\n+    Call *call = &CallControl.calls[self->num];\n+\n+    if (call->status != cs_Active) {\n+        error_str = \"Must be in a call\";\n         goto on_error;\n     }\n \n-    if (self->is_call == false) {\n-        error_str = \"Must be in a call\";\n+    if (argc == 0) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0,\n+                      \"Current audio encoding bitrate: %u\", call->audio_bit_rate);\n+        return;\n+    }\n+\n+    if (argc > 1) {\n+        error_str = \"Too many arguments.\";\n         goto on_error;\n     }\n \n-    const uint32_t bitrate = strtol(argv[1], NULL, 10);\n+    char *end;\n+    const long int bit_rate = strtol(argv[1], &end, 10);\n+\n+    if (*end || bit_rate < 0) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690026",
            "id": 410690026,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDAyNg==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 863,
            "original_position": 812,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690026/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690026",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690356"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690356"
                }
            },
            "author_association": "MEMBER",
            "body": "This name is reserved for the C implementation (ISO C 7.1.3). I'd just use `CallStatus`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:16:36Z",
            "diff_hunk": "@@ -44,14 +44,28 @@ typedef enum _VideoError {\n \n #endif /* VIDEO */\n \n+/* Status transitions:\n+ * None -> Pending (call invitation made or received);\n+ * Pending -> None (invitation rejected or failed);\n+ * Pending -> Active (call starts);\n+ * Active -> None (call ends).\n+ */\n+typedef enum _CallStatus {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690356",
            "id": 410690356,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDM1Ng==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 53,
            "original_position": 10,
            "original_start_line": null,
            "path": "src/audio_call.h",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690356/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690356",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690518"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690518"
                }
            },
            "author_association": "MEMBER",
            "body": "I'm not a fan of multiple declarations on one line, but even less of a fan if the declarators declare names of different types, in this case `uint32_t` and `uint32_t[OPENAL_BUFS]`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:18:04Z",
            "diff_hunk": "@@ -46,125 +42,174 @@\n #include <unistd.h>\n #include <stdlib.h>\n #include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n+#include <math.h>\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690518",
            "id": 410690518,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDUxOA==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 74,
            "original_position": 66,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690518/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690518",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690621"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690621"
                }
            },
            "author_association": "MEMBER",
            "body": "Are these used outside of this file?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:18:53Z",
            "diff_hunk": "@@ -46,125 +42,174 @@\n #include <unistd.h>\n #include <stdlib.h>\n #include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n+#include <math.h>\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n+\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;\n+\n+void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n bool thread_running = true,",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690621",
            "id": 410690621,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDYyMQ==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 113,
            "original_position": 117,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690621/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690621",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690647"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690647"
                }
            },
            "author_association": "MEMBER",
            "body": "Redundant ().",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:19:04Z",
            "diff_hunk": "@@ -46,125 +42,174 @@\n #include <unistd.h>\n #include <stdlib.h>\n #include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n+#include <math.h>\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n+\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;\n+\n+void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n bool thread_running = true,\n      thread_paused = true;               /* Thread control */\n \n-void *thread_poll(void *);\n-/* Meet devices */\n #ifdef AUDIO\n-DeviceError init_devices(ToxAV *av_)\n-#else\n+static void *poll_input(void *);\n+#endif\n+\n+static uint32_t sound_mode(bool stereo)\n+{\n+    return (stereo ? AL_FORMAT_STEREO16 : AL_FORMAT_MONO16);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690647",
            "id": 410690647,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDY0Nw==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 122,
            "original_position": 130,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690647/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690647",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690662"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690662"
                }
            },
            "author_association": "MEMBER",
            "body": "++type (but I guess I won't mention these any further. Maybe at some point we can throw tokstyle at this code.)",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:19:23Z",
            "diff_hunk": "@@ -46,125 +42,174 @@\n #include <unistd.h>\n #include <stdlib.h>\n #include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n+#include <math.h>\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n+\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;\n+\n+void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n bool thread_running = true,\n      thread_paused = true;               /* Thread control */\n \n-void *thread_poll(void *);\n-/* Meet devices */\n #ifdef AUDIO\n-DeviceError init_devices(ToxAV *av_)\n-#else\n+static void *poll_input(void *);\n+#endif\n+\n+static uint32_t sound_mode(bool stereo)\n+{\n+    return (stereo ? AL_FORMAT_STEREO16 : AL_FORMAT_MONO16);\n+}\n+\n+static uint32_t sample_size(bool stereo)\n+{\n+    return (stereo ? 4 : 2);\n+}\n+\n DeviceError init_devices(void)\n-#endif /* AUDIO */\n {\n-    get_devices_names();\n+    audio_state = calloc(1, sizeof(AudioState));\n \n-    // Start poll thread\n-    if (pthread_mutex_init(&mutex, NULL) != 0) {\n+    if (audio_state == NULL) {\n         return de_InternalError;\n     }\n \n+    get_al_device_names();\n+\n+    for (DeviceType type = input; type <= output; type++) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690662",
            "id": 410690662,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDY2Mg==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 140,
            "original_position": 152,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690662/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690662",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410690793"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690793"
                }
            },
            "author_association": "MEMBER",
            "body": "Old style declaration. Use `(void)`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:20:37Z",
            "diff_hunk": "@@ -46,125 +42,174 @@\n #include <unistd.h>\n #include <stdlib.h>\n #include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n+#include <math.h>\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n+\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;\n+\n+void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n bool thread_running = true,\n      thread_paused = true;               /* Thread control */\n \n-void *thread_poll(void *);\n-/* Meet devices */\n #ifdef AUDIO\n-DeviceError init_devices(ToxAV *av_)\n-#else\n+static void *poll_input(void *);\n+#endif\n+\n+static uint32_t sound_mode(bool stereo)\n+{\n+    return (stereo ? AL_FORMAT_STEREO16 : AL_FORMAT_MONO16);\n+}\n+\n+static uint32_t sample_size(bool stereo)\n+{\n+    return (stereo ? 4 : 2);\n+}\n+\n DeviceError init_devices(void)\n-#endif /* AUDIO */\n {\n-    get_devices_names();\n+    audio_state = calloc(1, sizeof(AudioState));\n \n-    // Start poll thread\n-    if (pthread_mutex_init(&mutex, NULL) != 0) {\n+    if (audio_state == NULL) {\n         return de_InternalError;\n     }\n \n+    get_al_device_names();\n+\n+    for (DeviceType type = input; type <= output; type++) {\n+        audio_state->al_device[type] = NULL;\n+\n+        if (pthread_mutex_init(&audio_state->mutex[type], NULL) != 0) {\n+            return de_InternalError;\n+        }\n+    }\n+\n+#ifdef AUDIO\n+    // Start poll thread\n     pthread_t thread_id;\n \n-    if (pthread_create(&thread_id, NULL, thread_poll, NULL) != 0 || pthread_detach(thread_id) != 0) {\n+    if (pthread_create(&thread_id, NULL, poll_input, NULL) != 0 || pthread_detach(thread_id) != 0) {\n         return de_InternalError;\n     }\n \n-#ifdef AUDIO\n-    av = av_;\n-#endif /* AUDIO */\n+#endif\n \n-    return (DeviceError) de_None;\n+    return de_None;\n }\n \n DeviceError terminate_devices(void)\n {\n-    /* Cleanup if needed */\n-    lock;\n+    lock(input);\n     thread_running = false;\n-    unlock;\n+    unlock(input);\n \n     usleep(20000);\n \n-    if (pthread_mutex_destroy(&mutex) != 0) {\n-        return (DeviceError) de_InternalError;\n+    for (DeviceType type = input; type <= output; type++) {\n+        if (pthread_mutex_destroy(&audio_state->mutex[type]) != 0) {\n+            return de_InternalError;\n+        }\n+\n+        if (audio_state->current_al_device_name[type] != NULL) {\n+            free(audio_state->current_al_device_name[type]);\n+        }\n     }\n \n-    return (DeviceError) de_None;\n+    free(audio_state);\n+\n+    return de_None;\n }\n \n-void get_devices_names(void)\n+void get_al_device_names()",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410690793",
            "id": 410690793,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MDc5Mw==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 184,
            "original_position": 208,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690793/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410690793",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410691196"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410691196"
                }
            },
            "author_association": "MEMBER",
            "body": "Use `!...` instead of `== false`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:24:32Z",
            "diff_hunk": "@@ -158,13 +151,22 @@ int start_video_transmission(ToxWindow *self, ToxAV *av, Call *call)\n         return -1;\n     }\n \n+    if (toxav_video_set_bit_rate(CallControl.av, self->num, call->video_bit_rate, NULL) == false) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410691196",
            "id": 410691196,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5MTE5Ng==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 154,
            "original_position": 90,
            "original_start_line": null,
            "path": "src/video_call.c",
            "position": null,
            "pull_request_review_id": 395908141,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410691196/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410691196",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410693759"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410693759"
                }
            },
            "author_association": "MEMBER",
            "body": "`peer` shadows `peer` of different type. Prefer to use a different name for one of them (I'd rename the one on line 842).",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:47:42Z",
            "diff_hunk": "@@ -598,6 +836,55 @@ static void groupchat_onKey(ToxWindow *self, Tox *m, wint_t key, bool ltr)\n     }\n }\n \n+static void draw_peer(ToxWindow *self, Tox *m, ChatContext *ctx, uint32_t i)\n+{\n+    pthread_mutex_lock(&Winthread.lock);\n+    const uint32_t peer = i + groupchats[self->num].side_pos;\n+    const uint32_t peernum = groupchats[self->num].name_list[peer].peernum;\n+    const bool is_self = tox_conference_peer_number_is_ours(m, self->num, peernum, NULL);\n+    const bool audio = groupchats[self->num].audio_enabled;\n+    pthread_mutex_unlock(&Winthread.lock);\n+\n+    /* truncate nick to fit in side panel without modifying list */\n+    char tmpnck[TOX_MAX_NAME_LENGTH];\n+    int maxlen = SIDEBAR_WIDTH - 2 - 2 * audio;\n+\n+    if (audio) {\n+        pthread_mutex_lock(&Winthread.lock);\n+        const GroupPeer *peer = &groupchats[self->num].peer_list[peernum];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410693759",
            "id": 410693759,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5Mzc1OQ==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 854,
            "original_position": 530,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410693759/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410693759",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410694182"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694182"
                }
            },
            "author_association": "MEMBER",
            "body": "This can be `static`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:50:50Z",
            "diff_hunk": "@@ -37,131 +33,180 @@\n #include <AL/alext.h>\n #endif /* ALC_ALL_DEVICES_SPECIFIER */\n \n+#include <assert.h>\n+#include <math.h>\n+#include <pthread.h>\n #include <stdbool.h>\n+#include <stdlib.h>\n #include <string.h>\n-#include <pthread.h>\n #include <unistd.h>\n-#include <stdlib.h>\n-#include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n+\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410694182",
            "id": 410694182,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5NDE4Mg==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 100,
            "original_position": 117,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694182/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694182",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410694215"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694215"
                }
            },
            "author_association": "MEMBER",
            "body": "Looks like no - they can be `static`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:51:08Z",
            "diff_hunk": "@@ -46,125 +42,174 @@\n #include <unistd.h>\n #include <stdlib.h>\n #include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n+#include <math.h>\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n+\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;\n+\n+void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n bool thread_running = true,",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410694215",
            "id": 410694215,
            "in_reply_to_id": 410690621,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5NDIxNQ==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 113,
            "original_position": 117,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694215/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694215",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410694555"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694555"
                }
            },
            "author_association": "MEMBER",
            "body": "These functions can also be `static`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:52:52Z",
            "diff_hunk": "@@ -37,131 +33,180 @@\n #include <AL/alext.h>\n #endif /* ALC_ALL_DEVICES_SPECIFIER */\n \n+#include <assert.h>\n+#include <math.h>\n+#include <pthread.h>\n #include <stdbool.h>\n+#include <stdlib.h>\n #include <string.h>\n-#include <pthread.h>\n #include <unistd.h>\n-#include <stdlib.h>\n-#include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source, buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n+\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+AudioState *audio_state;\n+\n+void lock(DeviceType type)",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410694555",
            "id": 410694555,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5NDU1NQ==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 102,
            "original_position": 119,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694555/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694555",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410694800"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694800"
                }
            },
            "author_association": "MEMBER",
            "body": "`a` and `b` are ptr-to-const. Please cast to another ptr-to-const.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:54:13Z",
            "diff_hunk": "@@ -301,6 +352,65 @@ static void groupchat_onGroupTitleChange(ToxWindow *self, Tox *m, uint32_t group\n     write_to_log(tmp_event, nick, ctx->log, true);\n }\n \n+/* Puts `(NameListEntry *)`s in `entries` for each matched peer, up to a maximum\n+ * of `maxpeers`.\n+ * Maches each peer whose name or pubkey begins with `prefix`.\n+ * If `prefix` is exactly the pubkey of a peer, matches only that peer.\n+ * return number of entries placed in `entries`.\n+ */\n+uint32_t get_name_list_entries_by_prefix(uint32_t groupnumber, const char *prefix, NameListEntry **entries,\n+        uint32_t maxpeers)\n+{\n+    GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active) {\n+        return 0;\n+    }\n+\n+    const int len = strlen(prefix);\n+\n+    if (len == 2 * TOX_PUBLIC_KEY_SIZE) {\n+        for (uint32_t i = 0; i < chat->num_peers; ++i) {\n+            if (strcasecmp(prefix, chat->name_list[i].pubkey_str) == 0) {\n+                entries[0] = &chat->name_list[i];\n+                return 1;\n+            }\n+        }\n+    }\n+\n+    uint32_t n = 0;\n+\n+    for (uint32_t i = 0; i < chat->num_peers; ++i) {\n+        if (strncmp(prefix, chat->name_list[i].name, len) == 0\n+                || strncasecmp(prefix, chat->name_list[i].pubkey_str, len) == 0) {\n+            entries[n] = &chat->name_list[i];\n+            ++n;\n+\n+            if (n == maxpeers) {\n+                return n;\n+            }\n+        }\n+    }\n+\n+    return n;\n+}\n+\n+\n+static int compare_name_list_entries(const void *a, const void *b)\n+{\n+    const int cmp1 = qsort_strcasecmp_hlpr(\n+                         ((NameListEntry *)a)->name,",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410694800",
            "id": 410694800,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5NDgwMA==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 402,
            "original_position": 216,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694800/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694800",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410694902"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694902"
                }
            },
            "author_association": "MEMBER",
            "body": "cbend is never used.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:55:18Z",
            "diff_hunk": "@@ -63,36 +64,12 @@ extern ToxWindow *windows[MAX_WINDOWS_NUM];\n \n struct CallControl CallControl;\n \n+extern struct Winthread Winthread;\n+\n #define cbend pthread_exit(NULL)",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410694902",
            "id": 410694902,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5NDkwMg==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 69,
            "original_position": 48,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694902/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694902",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410694937"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694937"
                }
            },
            "author_association": "MEMBER",
            "body": "frame_size is also never used. It's also a super confusing macro in and of itself, especially given that the name \"frame_size\" does appear quite often, but isn't this macro.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T12:55:39Z",
            "diff_hunk": "@@ -63,36 +64,12 @@ extern ToxWindow *windows[MAX_WINDOWS_NUM];\n \n struct CallControl CallControl;\n \n+extern struct Winthread Winthread;\n+\n #define cbend pthread_exit(NULL)\n \n #define frame_size (CallControl.audio_sample_rate * CallControl.audio_frame_duration / 1000)",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410694937",
            "id": 410694937,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5NDkzNw==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 71,
            "original_position": 50,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395910999,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694937/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410694937",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410697799"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410697799"
                }
            },
            "author_association": "MEMBER",
            "body": "nit: 1 space too many.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T13:19:49Z",
            "diff_hunk": "@@ -92,26 +92,29 @@ static struct cmd_func chat_commands[] = {\n     { \"/bitrate\",   cmd_bitrate     },\n #endif /* AUDIO */\n #ifdef VIDEO\n+    { \"/vcall\",     cmd_vcall       },\n     { \"/video\",     cmd_video       },\n+    { \"/res\",       cmd_res         },\n #endif /* VIDEO */\n     { NULL,         NULL            },\n };\n \n static struct cmd_func group_commands[] = {\n-    { \"/title\",     cmd_set_title   },\n+    { \"/title\",     cmd_set_title     },",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410697799",
            "id": 410697799,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5Nzc5OQ==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 103,
            "original_position": 39,
            "original_start_line": null,
            "path": "src/execute.c",
            "position": null,
            "pull_request_review_id": 395913402,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410697799/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410697799",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410697843"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410697843"
                }
            },
            "author_association": "MEMBER",
            "body": "add 1 space",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T13:20:21Z",
            "diff_hunk": "@@ -92,26 +92,29 @@ static struct cmd_func chat_commands[] = {\n     { \"/bitrate\",   cmd_bitrate     },\n #endif /* AUDIO */\n #ifdef VIDEO\n+    { \"/vcall\",     cmd_vcall       },\n     { \"/video\",     cmd_video       },\n+    { \"/res\",       cmd_res         },\n #endif /* VIDEO */\n     { NULL,         NULL            },\n };\n \n static struct cmd_func group_commands[] = {\n-    { \"/title\",     cmd_set_title   },\n+    { \"/title\",     cmd_set_title     },\n \n #ifdef AUDIO\n-    { \"/mute\",      cmd_mute        },\n-    { \"/sense\",     cmd_sense       },\n+    { \"/audio\",     cmd_enable_audio },\n+    { \"/mute\",      cmd_group_mute   },\n+    { \"/sense\",     cmd_group_sense  },\n #endif /* AUDIO */\n     { NULL,         NULL            },",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410697843",
            "id": 410697843,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5Nzg0Mw==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 110,
            "original_position": 48,
            "original_start_line": null,
            "path": "src/execute.c",
            "position": null,
            "pull_request_review_id": 395913402,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410697843/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410697843",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410698153"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410698153"
                }
            },
            "author_association": "MEMBER",
            "body": "`(double)` is implicit in vararg passing (6.5.2.2p7).",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T13:23:17Z",
            "diff_hunk": "@@ -79,3 +86,97 @@ void cmd_set_title(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*arg\n     snprintf(tmp_event, sizeof(tmp_event), \"set title to %s\", title);\n     write_to_log(tmp_event, selfnick, self->chatwin->log, true);\n }\n+\n+#ifdef AUDIO\n+void cmd_enable_audio(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[MAX_STR_SIZE])\n+{\n+    UNUSED_VAR(window);\n+\n+    bool enable;\n+\n+    if (argc == 1 && !strcasecmp(argv[1], \"on\")) {\n+        enable = true;\n+    } else if (argc == 1 && !strcasecmp(argv[1], \"off\")) {\n+        enable = false;\n+    } else {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Please specify: on | off\");\n+        return;\n+    }\n+\n+    if ((enable ? enable_group_audio : disable_group_audio)(m, self->num)) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, enable ? \"Enabled group audio\" : \"Disabled group audio\");\n+    } else {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, enable ? \"Failed to enable audio\" : \"Failed to disable audio\");\n+    }\n+\n+}\n+\n+void cmd_group_mute(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[MAX_STR_SIZE])\n+{\n+    UNUSED_VAR(window);\n+\n+    if (argc < 1) {\n+        if (group_mute_self(self->num)) {\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Toggled self audio mute status\");\n+        } else {\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"No audio input to mute\");\n+        }\n+    } else {\n+        NameListEntry *entries[16];\n+        uint32_t n = get_name_list_entries_by_prefix(self->num, argv[1], entries, 16);\n+\n+        if (n == 0) {\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"No such peer\");\n+            return;\n+        }\n+\n+        if (n > 1) {\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0,\n+                          \"Multiple matching peers (use /mute [public key] to disambiguate):\");\n+\n+            for (uint32_t i = 0; i < n; ++i) {\n+                line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"%s: %s\", entries[i]->pubkey_str, entries[i]->name);\n+            }\n+\n+            return;\n+        }\n+\n+        if (group_mute_peer(m, self->num, entries[0]->peernum)) {\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Toggled audio mute status of %s\", entries[0]->name);\n+        } else {\n+            line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"No such audio peer\");\n+        }\n+    }\n+}\n+\n+void cmd_group_sense(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[MAX_STR_SIZE])\n+{\n+    UNUSED_VAR(window);\n+    UNUSED_VAR(m);\n+\n+    if (argc == 0) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Current VAD threshold: %.1f\",\n+                      (double) group_get_VAD_threshold(self->num));\n+        return;\n+    }\n+\n+    if (argc > 1) {\n+        print_err(self, \"Only one argument allowed.\");\n+        return;\n+    }\n+\n+    char *end;\n+    float value = strtof(argv[1], &end);\n+\n+    if (*end) {\n+        print_err(self, \"Invalid input\");\n+        return;\n+    }\n+\n+    if (group_set_VAD_threshold(self->num, value)) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Set VAD threshold to %.1f\", (double) value);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410698153",
            "id": 410698153,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5ODE1Mw==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 175,
            "original_position": 116,
            "original_start_line": null,
            "path": "src/group_commands.c",
            "position": null,
            "pull_request_review_id": 395913402,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410698153/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410698153",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410698882"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410698882"
                }
            },
            "author_association": "MEMBER",
            "body": "You may want to use size_t here, or cast to `(int)` explicitly if you mean a conversion.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T13:29:55Z",
            "diff_hunk": "@@ -301,6 +352,65 @@ static void groupchat_onGroupTitleChange(ToxWindow *self, Tox *m, uint32_t group\n     write_to_log(tmp_event, nick, ctx->log, true);\n }\n \n+/* Puts `(NameListEntry *)`s in `entries` for each matched peer, up to a maximum\n+ * of `maxpeers`.\n+ * Maches each peer whose name or pubkey begins with `prefix`.\n+ * If `prefix` is exactly the pubkey of a peer, matches only that peer.\n+ * return number of entries placed in `entries`.\n+ */\n+uint32_t get_name_list_entries_by_prefix(uint32_t groupnumber, const char *prefix, NameListEntry **entries,\n+        uint32_t maxpeers)\n+{\n+    GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active) {\n+        return 0;\n+    }\n+\n+    const int len = strlen(prefix);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410698882",
            "id": 410698882,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5ODg4Mg==",
            "original_commit_id": "bafcf40cbaf82e3b1459cf858a646cafcdb8d2d5",
            "original_line": 370,
            "original_position": 184,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395913402,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410698882/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410698882",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410710324"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410710324"
                }
            },
            "author_association": "MEMBER",
            "body": "const?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T15:13:16Z",
            "diff_hunk": "@@ -820,9 +832,11 @@ void cmd_sense(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[M\n         goto on_error;\n     }\n \n+    Call *call = &CallControl.calls[self->num];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410710324",
            "id": 410710324,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcxMDMyNA==",
            "original_commit_id": "32cc7d8cda2c42a56f15ded604a98b118ceb1c3a",
            "original_line": 835,
            "original_position": 111,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395922249,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410710324/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410710324",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410719742"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410719742"
                }
            },
            "author_association": "MEMBER",
            "body": "`(void)`\r\n\r\nIf you don't put anything in the (), these become variadic functions, so we have no guards against accidentally passing parameters.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T16:34:53Z",
            "diff_hunk": "@@ -55,42 +56,42 @@ typedef enum DeviceError {\n typedef void (*DataHandleCallback)(const int16_t *, uint32_t size, void *data);\n \n \n-#ifdef AUDIO\n-DeviceError init_devices(ToxAV *av);\n-#else\n DeviceError init_devices(void);\n-#endif /* AUDIO */\n \n-void get_devices_names(void);\n+void get_al_device_names(void);\n DeviceError terminate_devices(void);\n \n-/* Callback handles ready data from INPUT device */\n-DeviceError register_device_callback(int32_t friend_number, uint32_t device_idx, DataHandleCallback callback,\n-                                     void *data, bool enable_VAD);\n-void *get_device_callback_data(uint32_t device_idx);\n-\n /* toggle device mute */\n DeviceError device_mute(DeviceType type, uint32_t device_idx);\n \n-#ifdef AUDIO\n-DeviceError device_set_VAD_treshold(uint32_t device_idx, float value);\n-#endif\n+bool device_is_muted(DeviceType type, uint32_t device_idx);\n+\n+DeviceError device_set_VAD_threshold(uint32_t device_idx, float value);\n+\n+float device_get_VAD_threshold(uint32_t device_idx);\n+\n+DeviceError set_source_position(uint32_t device_idx, float x, float y, float z);\n+\n+DeviceError set_al_device(DeviceType type, int32_t selection);\n \n-DeviceError set_primary_device(DeviceType type, int32_t selection);\n-DeviceError open_primary_device(DeviceType type, uint32_t *device_idx, uint32_t sample_rate, uint32_t frame_duration,\n-                                uint8_t channels);\n /* Start device */\n-DeviceError open_device(DeviceType type, int32_t selection, uint32_t *device_idx, uint32_t sample_rate,\n-                        uint32_t frame_duration, uint8_t channels);\n+DeviceError open_input_device(uint32_t *device_idx,\n+                              DataHandleCallback cb, void *cb_data, bool enable_VAD,\n+                              uint32_t sample_rate, uint32_t frame_duration, uint8_t channels);\n+DeviceError open_output_device(uint32_t *device_idx,\n+                               uint32_t sample_rate, uint32_t frame_duration, uint8_t channels);\n+\n /* Stop device */\n DeviceError close_device(DeviceType type, uint32_t device_idx);\n \n-/* Write data to device */\n+/* Write data to output device */\n DeviceError write_out(uint32_t device_idx, const int16_t *data, uint32_t length, uint8_t channels,\n                       uint32_t sample_rate);\n \n-void print_devices(ToxWindow *self, DeviceType type);\n-void get_primary_device_name(DeviceType type, char *buf, int size);\n+/* return current input volume as float in range 0.0-100.0 */\n+float get_input_volume();",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410719742",
            "id": 410719742,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcxOTc0Mg==",
            "original_commit_id": "32cc7d8cda2c42a56f15ded604a98b118ceb1c3a",
            "original_line": 92,
            "original_position": 66,
            "original_start_line": null,
            "path": "src/audio_device.h",
            "position": null,
            "pull_request_review_id": 395929212,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410719742/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410719742",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410720841"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410720841"
                }
            },
            "author_association": "MEMBER",
            "body": "powf (and \"f\" functions in other places where you work with floats).",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T16:43:57Z",
            "diff_hunk": "@@ -447,98 +639,129 @@ inline__ DeviceError write_out(uint32_t device_idx, const int16_t *data, uint32_\n         alSourcePlay(device->source);\n     }\n \n-\n-    pthread_mutex_unlock(device->mutex);\n+    unlock(output);\n     return de_None;\n }\n \n-void *thread_poll(void *arg)  // TODO: maybe use thread for every input source\n+#ifdef AUDIO\n+/* Adapted from qtox,\n+ * Copyright © 2014-2019 by The qTox Project Contributors\n+ *\n+ * return normalized volume of buffer in range 0.0-100.0\n+ */\n+float volume(int16_t *frame, uint32_t samples)\n {\n-    /*\n-     * NOTE: We only need to poll input devices for data.\n-     */\n-    UNUSED_VAR(arg);\n-    uint32_t i;\n-    int32_t sample = 0;\n+    float sumOfSquares = 0;\n \n+    for (uint32_t i = 0; i < samples; i++) {\n+        const float sample = (float)(frame[i]) / INT16_MAX;\n+        sumOfSquares += pow(sample, 2);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410720841",
            "id": 410720841,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMDg0MQ==",
            "original_commit_id": "32cc7d8cda2c42a56f15ded604a98b118ceb1c3a",
            "original_line": 658,
            "original_position": 862,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395930012,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410720841/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410720841",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410721666"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410721666"
                }
            },
            "author_association": "MEMBER",
            "body": "sumOfSquares seems to be against the naming standard in toxic. I see it's taken from qtox, but maybe adapt it a bit more to use toxic naming standards.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T16:50:33Z",
            "diff_hunk": "@@ -447,98 +639,129 @@ inline__ DeviceError write_out(uint32_t device_idx, const int16_t *data, uint32_\n         alSourcePlay(device->source);\n     }\n \n-\n-    pthread_mutex_unlock(device->mutex);\n+    unlock(output);\n     return de_None;\n }\n \n-void *thread_poll(void *arg)  // TODO: maybe use thread for every input source\n+#ifdef AUDIO\n+/* Adapted from qtox,\n+ * Copyright © 2014-2019 by The qTox Project Contributors\n+ *\n+ * return normalized volume of buffer in range 0.0-100.0\n+ */\n+float volume(int16_t *frame, uint32_t samples)\n {\n-    /*\n-     * NOTE: We only need to poll input devices for data.\n-     */\n-    UNUSED_VAR(arg);\n-    uint32_t i;\n-    int32_t sample = 0;\n+    float sumOfSquares = 0;",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410721666",
            "id": 410721666,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMTY2Ng==",
            "original_commit_id": "32cc7d8cda2c42a56f15ded604a98b118ceb1c3a",
            "original_line": 654,
            "original_position": 858,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395930590,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410721666/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410721666",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410722282"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722282"
                }
            },
            "author_association": "MEMBER",
            "body": "I feel like we should factor out this long a && b && c expression into a function and use it in these callbacks. WDYT?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T16:55:25Z",
            "diff_hunk": "@@ -386,76 +413,85 @@ void callback_recv_invite(Tox *m, uint32_t friend_number)\n         Friends.list[friend_number].chatwin = add_window(m, new_chat(m, Friends.list[friend_number].num));\n     }\n \n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onInvite != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onInvite(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onInvite(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_ringing(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onRinging != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onRinging(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onRinging(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_starting(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStarting != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStarting(windows[i], CallControl.av, friend_number, CallControl.call_state);\n-\n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) { /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-            }\n+            windows[i]->onStarting(windows[i], CallControl.av, friend_number, call->state);\n \n-            return;\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_recv_ending(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onEnding != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onEnding(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onEnding(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_call_started(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStart != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStart(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onStart(windows[i], CallControl.av, friend_number, call->state);\n \n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) {  /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-                return;\n-            }\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_call_canceled(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onCancel != NULL && windows[i]->num == friend_number) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410722282",
            "id": 410722282,
            "line": 473,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjI4Mg==",
            "original_commit_id": "50d7f8323a43b2162a68f5be3e0d9de7dcc00cc8",
            "original_line": 473,
            "original_position": 544,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 558,
            "pull_request_review_id": 395931007,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722282/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722282",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410722483"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722483"
                }
            },
            "author_association": "MEMBER",
            "body": "Ah, they are all slightly different. Maybe factor out the 2 common bits?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T16:57:23Z",
            "diff_hunk": "@@ -386,76 +413,85 @@ void callback_recv_invite(Tox *m, uint32_t friend_number)\n         Friends.list[friend_number].chatwin = add_window(m, new_chat(m, Friends.list[friend_number].num));\n     }\n \n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onInvite != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onInvite(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onInvite(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_ringing(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onRinging != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onRinging(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onRinging(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_starting(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStarting != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStarting(windows[i], CallControl.av, friend_number, CallControl.call_state);\n-\n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) { /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-            }\n+            windows[i]->onStarting(windows[i], CallControl.av, friend_number, call->state);\n \n-            return;\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_recv_ending(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onEnding != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onEnding(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onEnding(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_call_started(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStart != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStart(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onStart(windows[i], CallControl.av, friend_number, call->state);\n \n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) {  /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-                return;\n-            }\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_call_canceled(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onCancel != NULL && windows[i]->num == friend_number) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410722483",
            "id": 410722483,
            "in_reply_to_id": 410722282,
            "line": 473,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjQ4Mw==",
            "original_commit_id": "50d7f8323a43b2162a68f5be3e0d9de7dcc00cc8",
            "original_line": 473,
            "original_position": 544,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 558,
            "pull_request_review_id": 395931205,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722483/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722483",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410722611"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722611"
                }
            },
            "author_association": "MEMBER",
            "body": "On third read, it seems you can generalise these functions entirely and make each of them 1 line.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T16:58:21Z",
            "diff_hunk": "@@ -386,76 +413,85 @@ void callback_recv_invite(Tox *m, uint32_t friend_number)\n         Friends.list[friend_number].chatwin = add_window(m, new_chat(m, Friends.list[friend_number].num));\n     }\n \n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onInvite != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onInvite(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onInvite(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_ringing(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onRinging != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onRinging(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onRinging(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_starting(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStarting != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStarting(windows[i], CallControl.av, friend_number, CallControl.call_state);\n-\n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) { /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-            }\n+            windows[i]->onStarting(windows[i], CallControl.av, friend_number, call->state);\n \n-            return;\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_recv_ending(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onEnding != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onEnding(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onEnding(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_call_started(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStart != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStart(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onStart(windows[i], CallControl.av, friend_number, call->state);\n \n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) {  /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-                return;\n-            }\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_call_canceled(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onCancel != NULL && windows[i]->num == friend_number) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410722611",
            "id": 410722611,
            "in_reply_to_id": 410722282,
            "line": 473,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjYxMQ==",
            "original_commit_id": "50d7f8323a43b2162a68f5be3e0d9de7dcc00cc8",
            "original_line": 473,
            "original_position": 544,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 558,
            "pull_request_review_id": 395931287,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722611/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722611",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410722904"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722904"
                }
            },
            "author_association": "MEMBER",
            "body": "This violates MISRA C:2012 required rule 13.5: \"The right hand operand of a logical && or || operator shall not\r\ncontain persistent side effects\". Up to you whether you want to comply, though.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:00:26Z",
            "diff_hunk": "@@ -37,131 +33,181 @@\n #include <AL/alext.h>\n #endif /* ALC_ALL_DEVICES_SPECIFIER */\n \n+#include <assert.h>\n+#include <math.h>\n+#include <pthread.h>\n #include <stdbool.h>\n+#include <stdlib.h>\n #include <string.h>\n-#include <pthread.h>\n #include <unistd.h>\n-#include <stdlib.h>\n-#include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source;\n+    uint32_t buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n+\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+static AudioState *audio_state;\n+\n+static void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+static void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n-bool thread_running = true,\n-     thread_paused = true;               /* Thread control */\n+static bool thread_running = true,\n+            thread_paused = true;               /* Thread control */\n \n-void *thread_poll(void *);\n-/* Meet devices */\n #ifdef AUDIO\n-DeviceError init_devices(ToxAV *av_)\n-#else\n+static void *poll_input(void *);\n+#endif\n+\n+static uint32_t sound_mode(bool stereo)\n+{\n+    return stereo ? AL_FORMAT_STEREO16 : AL_FORMAT_MONO16;\n+}\n+\n+static uint32_t sample_size(bool stereo)\n+{\n+    return stereo ? 4 : 2;\n+}\n+\n DeviceError init_devices(void)\n-#endif /* AUDIO */\n {\n-    get_devices_names();\n+    audio_state = calloc(1, sizeof(AudioState));\n \n-    // Start poll thread\n-    if (pthread_mutex_init(&mutex, NULL) != 0) {\n+    if (audio_state == NULL) {\n         return de_InternalError;\n     }\n \n+    get_al_device_names();\n+\n+    for (DeviceType type = input; type <= output; ++type) {\n+        audio_state->al_device[type] = NULL;\n+\n+        if (pthread_mutex_init(&audio_state->mutex[type], NULL) != 0) {\n+            return de_InternalError;\n+        }\n+    }\n+\n+#ifdef AUDIO\n+    // Start poll thread\n     pthread_t thread_id;\n \n-    if (pthread_create(&thread_id, NULL, thread_poll, NULL) != 0 || pthread_detach(thread_id) != 0) {\n+    if (pthread_create(&thread_id, NULL, poll_input, NULL) != 0 || pthread_detach(thread_id) != 0) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410722904",
            "id": 410722904,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjkwNA==",
            "original_commit_id": "2b635790446a80563ce7707541a31c4ed99eb049",
            "original_line": 153,
            "original_position": 181,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395931485,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722904/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410722904",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410724076"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410724076"
                }
            },
            "author_association": "MEMBER",
            "body": "Is there a nice way to avoid having the same \"enable?:\" 3 times, and also avoid the use of function pointers in the if-condition?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:09:39Z",
            "diff_hunk": "@@ -79,3 +86,97 @@ void cmd_set_title(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*arg\n     snprintf(tmp_event, sizeof(tmp_event), \"set title to %s\", title);\n     write_to_log(tmp_event, selfnick, self->chatwin->log, true);\n }\n+\n+#ifdef AUDIO\n+void cmd_enable_audio(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[MAX_STR_SIZE])\n+{\n+    UNUSED_VAR(window);\n+\n+    bool enable;\n+\n+    if (argc == 1 && !strcasecmp(argv[1], \"on\")) {\n+        enable = true;\n+    } else if (argc == 1 && !strcasecmp(argv[1], \"off\")) {\n+        enable = false;\n+    } else {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Please specify: on | off\");\n+        return;\n+    }\n+\n+    if ((enable ? enable_group_audio : disable_group_audio)(m, self->num)) {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, enable ? \"Enabled group audio\" : \"Disabled group audio\");\n+    } else {\n+        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, enable ? \"Failed to enable audio\" : \"Failed to disable audio\");\n+    }",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410724076",
            "id": 410724076,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNDA3Ng==",
            "original_commit_id": "2b635790446a80563ce7707541a31c4ed99eb049",
            "original_line": 110,
            "original_position": 49,
            "original_start_line": 106,
            "path": "src/group_commands.c",
            "position": null,
            "pull_request_review_id": 395931485,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410724076/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410724076",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410725260"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410725260"
                }
            },
            "author_association": "MEMBER",
            "body": "Can't generalise it after all (I misread things), and factoring out the common bits seems less useful now. Never mind.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:20:01Z",
            "diff_hunk": "@@ -386,76 +413,85 @@ void callback_recv_invite(Tox *m, uint32_t friend_number)\n         Friends.list[friend_number].chatwin = add_window(m, new_chat(m, Friends.list[friend_number].num));\n     }\n \n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onInvite != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onInvite(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onInvite(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_ringing(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onRinging != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onRinging(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onRinging(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_recv_starting(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStarting != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStarting(windows[i], CallControl.av, friend_number, CallControl.call_state);\n-\n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) { /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-            }\n+            windows[i]->onStarting(windows[i], CallControl.av, friend_number, call->state);\n \n-            return;\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_recv_ending(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onEnding != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onEnding(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onEnding(windows[i], CallControl.av, friend_number, call->state);\n         }\n     }\n }\n void callback_call_started(uint32_t friend_number)\n {\n+    Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onStart != NULL && windows[i]->num == friend_number) {\n-            windows[i]->onStart(windows[i], CallControl.av, friend_number, CallControl.call_state);\n+            windows[i]->onStart(windows[i], CallControl.av, friend_number, call->state);\n \n-            if (0 != start_transmission(windows[i], &CallControl.calls[friend_number])) {  /* YEAH! */\n-                line_info_add(windows[i], NULL, NULL, NULL, SYS_MSG, 0, 0, \"Error starting transmission!\");\n-                return;\n-            }\n+            start_call(windows[i], call);\n         }\n     }\n }\n void callback_call_canceled(uint32_t friend_number)\n {\n+    const Call *call = &CallControl.calls[friend_number];\n+\n     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n         if (windows[i] != NULL && windows[i]->onCancel != NULL && windows[i]->num == friend_number) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410725260",
            "id": 410725260,
            "in_reply_to_id": 410722282,
            "line": 473,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNTI2MA==",
            "original_commit_id": "50d7f8323a43b2162a68f5be3e0d9de7dcc00cc8",
            "original_line": 473,
            "original_position": 544,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 558,
            "pull_request_review_id": 395933150,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410725260/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410725260",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410726339"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410726339"
                }
            },
            "author_association": "MEMBER",
            "body": "Avoid implicit bool conversion: write `*stringed_device_list != '\\0'`",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:29:06Z",
            "diff_hunk": "@@ -37,131 +33,181 @@\n #include <AL/alext.h>\n #endif /* ALC_ALL_DEVICES_SPECIFIER */\n \n+#include <assert.h>\n+#include <math.h>\n+#include <pthread.h>\n #include <stdbool.h>\n+#include <stdlib.h>\n #include <string.h>\n-#include <pthread.h>\n #include <unistd.h>\n-#include <stdlib.h>\n-#include <assert.h>\n-\n-#define inline__ inline __attribute__((always_inline))\n \n extern struct user_settings *user_settings;\n+extern struct Winthread Winthread;\n \n+typedef struct FrameInfo {\n+    uint32_t samples_per_frame;\n+    uint32_t sample_rate;\n+    bool stereo;\n+} FrameInfo;\n+\n+/* A virtual input/output device, abstracting the currently selected openal\n+ * device (which may change during the lifetime of the virtual device).\n+ * We refer to a virtual device as a \"device\", and refer to an underlying\n+ * openal device as an \"al_device\".\n+ * Multiple virtual devices may be open at once; the callback of each virtual\n+ * input device has data captured from the input al_device passed to it, and\n+ * each virtual output device acts as a source for the output al_device.\n+ */\n typedef struct Device {\n-    ALCdevice  *dhndl;                     /* Handle of device selected/opened */\n-    ALCcontext *ctx;                       /* Device context */\n-    DataHandleCallback cb;                 /* Use this to handle data from input device usually */\n-    void *cb_data;                         /* Data to be passed to callback */\n-    int32_t friend_number;                      /* ToxAV friend number */\n-\n-    uint32_t source, buffers[OPENAL_BUFS]; /* Playback source/buffers */\n-    uint32_t ref_count;\n-    int32_t selection;\n-    bool enable_VAD;\n+    bool active;\n     bool muted;\n-    pthread_mutex_t mutex[1];\n-    uint32_t sample_rate;\n-    uint32_t frame_duration;\n-    int32_t sound_mode;\n-#ifdef AUDIO\n-    float VAD_treshold;                    /* 40 is usually recommended value */\n-#endif\n+\n+    FrameInfo frame_info;\n+\n+    // used only by input devices:\n+    DataHandleCallback cb;\n+    void *cb_data;\n+    float VAD_threshold;\n+    uint32_t VAD_samples_remaining;\n+\n+    // used only by output devices:\n+    uint32_t source;\n+    uint32_t buffers[OPENAL_BUFS];\n+    bool source_open;\n } Device;\n \n-const char *ddevice_names[2];              /* Default device */\n-const char *devices_names[2][MAX_DEVICES]; /* Container of available devices */\n-static int size[2];                        /* Size of above containers */\n-Device *running[2][MAX_DEVICES] = {{NULL}};     /* Running devices */\n-uint32_t primary_device[2];          /* Primary device */\n+typedef struct AudioState {\n+    ALCdevice *al_device[2];\n \n-#ifdef AUDIO\n-static ToxAV *av = NULL;\n-#endif /* AUDIO */\n+    Device devices[2][MAX_DEVICES];\n+    uint32_t num_devices[2];\n+\n+    FrameInfo capture_frame_info;\n+    float input_volume;\n+\n+    // mutexes to prevent changes to input resp. output devices and al_devices\n+    // during poll_input iterations resp. calls to write_out;\n+    // mutex[input] also used to lock input_volume which poll_input writes to.\n+    pthread_mutex_t mutex[2];\n+\n+    // TODO: unused\n+    const char *default_al_device_name[2];              /* Default devices */\n \n-/* q_mutex */\n-#define lock pthread_mutex_lock(&mutex)\n-#define unlock pthread_mutex_unlock(&mutex)\n-pthread_mutex_t mutex;\n+    const char *al_device_names[2][MAX_OPENAL_DEVICES]; /* Available devices */\n+    uint32_t num_al_devices[2];\n+    char *current_al_device_name[2];\n+} AudioState;\n+\n+static AudioState *audio_state;\n+\n+static void lock(DeviceType type)\n+{\n+    pthread_mutex_lock(&audio_state->mutex[type]);\n+}\n+\n+static void unlock(DeviceType type)\n+{\n+    pthread_mutex_unlock(&audio_state->mutex[type]);\n+}\n \n \n-bool thread_running = true,\n-     thread_paused = true;               /* Thread control */\n+static bool thread_running = true,\n+            thread_paused = true;               /* Thread control */\n \n-void *thread_poll(void *);\n-/* Meet devices */\n #ifdef AUDIO\n-DeviceError init_devices(ToxAV *av_)\n-#else\n+static void *poll_input(void *);\n+#endif\n+\n+static uint32_t sound_mode(bool stereo)\n+{\n+    return stereo ? AL_FORMAT_STEREO16 : AL_FORMAT_MONO16;\n+}\n+\n+static uint32_t sample_size(bool stereo)\n+{\n+    return stereo ? 4 : 2;\n+}\n+\n DeviceError init_devices(void)\n-#endif /* AUDIO */\n {\n-    get_devices_names();\n+    audio_state = calloc(1, sizeof(AudioState));\n \n-    // Start poll thread\n-    if (pthread_mutex_init(&mutex, NULL) != 0) {\n+    if (audio_state == NULL) {\n         return de_InternalError;\n     }\n \n+    get_al_device_names();\n+\n+    for (DeviceType type = input; type <= output; ++type) {\n+        audio_state->al_device[type] = NULL;\n+\n+        if (pthread_mutex_init(&audio_state->mutex[type], NULL) != 0) {\n+            return de_InternalError;\n+        }\n+    }\n+\n+#ifdef AUDIO\n+    // Start poll thread\n     pthread_t thread_id;\n \n-    if (pthread_create(&thread_id, NULL, thread_poll, NULL) != 0 || pthread_detach(thread_id) != 0) {\n+    if (pthread_create(&thread_id, NULL, poll_input, NULL) != 0 || pthread_detach(thread_id) != 0) {\n         return de_InternalError;\n     }\n \n-#ifdef AUDIO\n-    av = av_;\n-#endif /* AUDIO */\n+#endif\n \n-    return (DeviceError) de_None;\n+    return de_None;\n }\n \n DeviceError terminate_devices(void)\n {\n-    /* Cleanup if needed */\n-    lock;\n+    lock(input);\n     thread_running = false;\n-    unlock;\n+    unlock(input);\n \n     usleep(20000);\n \n-    if (pthread_mutex_destroy(&mutex) != 0) {\n-        return (DeviceError) de_InternalError;\n+    for (DeviceType type = input; type <= output; ++type) {\n+        if (pthread_mutex_destroy(&audio_state->mutex[type]) != 0) {\n+            return de_InternalError;\n+        }\n+\n+        if (audio_state->current_al_device_name[type] != NULL) {\n+            free(audio_state->current_al_device_name[type]);\n+        }\n     }\n \n-    return (DeviceError) de_None;\n+    free(audio_state);\n+\n+    return de_None;\n }\n \n-void get_devices_names(void)\n+void get_al_device_names(void)\n {\n-\n     const char *stringed_device_list;\n \n-    size[input] = 0;\n+    for (DeviceType type = input; type <= output; ++type) {\n+        audio_state->num_al_devices[type] = 0;\n \n-    if ((stringed_device_list = alcGetString(NULL, ALC_CAPTURE_DEVICE_SPECIFIER))) {\n-        ddevice_names[input] = alcGetString(NULL, ALC_CAPTURE_DEFAULT_DEVICE_SPECIFIER);\n-\n-        for (; *stringed_device_list && size[input] < MAX_DEVICES; ++size[input]) {\n-            devices_names[input][size[input]] = stringed_device_list;\n-            stringed_device_list += strlen(stringed_device_list) + 1;\n+        if (type == input) {\n+            stringed_device_list = alcGetString(NULL, ALC_CAPTURE_DEVICE_SPECIFIER);\n+        } else {\n+            if (alcIsExtensionPresent(NULL, \"ALC_ENUMERATE_ALL_EXT\") != AL_FALSE) {\n+                stringed_device_list = alcGetString(NULL, ALC_ALL_DEVICES_SPECIFIER);\n+            } else {\n+                stringed_device_list = alcGetString(NULL, ALC_DEVICE_SPECIFIER);\n+            }\n         }\n-    }\n \n-    size[output] = 0;\n+        if (stringed_device_list != NULL) {\n+            audio_state->default_al_device_name[type] = alcGetString(NULL,\n+                    type == input ? ALC_CAPTURE_DEFAULT_DEVICE_SPECIFIER : ALC_DEFAULT_DEVICE_SPECIFIER);\n \n-    if (alcIsExtensionPresent(NULL, \"ALC_ENUMERATE_ALL_EXT\") != AL_FALSE) {\n-        stringed_device_list = alcGetString(NULL, ALC_ALL_DEVICES_SPECIFIER);\n-    } else {\n-        stringed_device_list = alcGetString(NULL, ALC_DEVICE_SPECIFIER);\n-    }\n-\n-    if (stringed_device_list) {\n-        ddevice_names[output] = alcGetString(NULL, ALC_DEFAULT_DEVICE_SPECIFIER);\n-\n-        for (; *stringed_device_list && size[output] < MAX_DEVICES; ++size[output]) {\n-            devices_names[output][size[output]] = stringed_device_list;\n-            stringed_device_list += strlen(stringed_device_list) + 1;\n+            for (; *stringed_device_list",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410726339",
            "id": 410726339,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNjMzOQ==",
            "original_commit_id": "2b635790446a80563ce7707541a31c4ed99eb049",
            "original_line": 206,
            "original_position": 267,
            "original_start_line": null,
            "path": "src/audio_device.c",
            "position": null,
            "pull_request_review_id": 395933917,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410726339/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410726339",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410726840"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410726840"
                }
            },
            "author_association": "MEMBER",
            "body": "`groupchats[self->num]` is used several times. Assign it a name?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:33:43Z",
            "diff_hunk": "@@ -518,12 +725,20 @@ static void groupchat_onKey(ToxWindow *self, Tox *m, wint_t key, bool ltr)\n \n     if (key == '\\t') {  /* TAB key: auto-completes peer name or command */\n         if (ctx->len > 0) {\n-            int diff;\n+            int diff = -1;\n \n             /* TODO: make this not suck */\n             if (ctx->line[0] != L'/' || wcscmp(ctx->line, L\"/me\") == 0) {\n-                diff = complete_line(self, groupchats[self->num].name_list, groupchats[self->num].num_peers,\n-                                     TOX_MAX_NAME_LENGTH);\n+                char *names = malloc(groupchats[self->num].num_peers * TOX_MAX_NAME_LENGTH);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410726840",
            "id": 410726840,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNjg0MA==",
            "original_commit_id": "2b635790446a80563ce7707541a31c4ed99eb049",
            "original_line": 732,
            "original_position": 456,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395933917,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410726840/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410726840",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410727594"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410727594"
                }
            },
            "author_association": "MEMBER",
            "body": "I'd give a name to `&chat->name_list[i]` here (maybe also above), but it's borderline. What do you think?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:39:02Z",
            "diff_hunk": "@@ -301,6 +352,65 @@ static void groupchat_onGroupTitleChange(ToxWindow *self, Tox *m, uint32_t group\n     write_to_log(tmp_event, nick, ctx->log, true);\n }\n \n+/* Puts `(NameListEntry *)`s in `entries` for each matched peer, up to a maximum\n+ * of `maxpeers`.\n+ * Maches each peer whose name or pubkey begins with `prefix`.\n+ * If `prefix` is exactly the pubkey of a peer, matches only that peer.\n+ * return number of entries placed in `entries`.\n+ */\n+uint32_t get_name_list_entries_by_prefix(uint32_t groupnumber, const char *prefix, NameListEntry **entries,\n+        uint32_t maxpeers)\n+{\n+    GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active) {\n+        return 0;\n+    }\n+\n+    const size_t len = strlen(prefix);\n+\n+    if (len == 2 * TOX_PUBLIC_KEY_SIZE) {\n+        for (uint32_t i = 0; i < chat->num_peers; ++i) {\n+            if (strcasecmp(prefix, chat->name_list[i].pubkey_str) == 0) {\n+                entries[0] = &chat->name_list[i];\n+                return 1;\n+            }\n+        }\n+    }\n+\n+    uint32_t n = 0;\n+\n+    for (uint32_t i = 0; i < chat->num_peers; ++i) {\n+        if (strncmp(prefix, chat->name_list[i].name, len) == 0",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410727594",
            "id": 410727594,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNzU5NA==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 384,
            "original_position": 198,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410727594/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410727594",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410727709"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410727709"
                }
            },
            "author_association": "MEMBER",
            "body": "I'd give a name to `chat->name_list[i]` here.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:40:12Z",
            "diff_hunk": "@@ -313,25 +423,28 @@ static void group_update_name_list(uint32_t groupnum)\n         free(chat->name_list);\n     }\n \n-    chat->name_list = malloc(sizeof(char *) * chat->num_peers * TOX_MAX_NAME_LENGTH);\n+    chat->name_list = malloc(chat->num_peers * sizeof(NameListEntry));\n \n     if (chat->name_list == NULL) {\n         exit_toxic_err(\"failed in group_update_name_list\", FATALERR_MEMORY);\n     }\n \n-    uint32_t i, count = 0;\n+    uint32_t count = 0;\n \n-    for (i = 0; i < chat->max_idx; ++i) {\n+    for (uint32_t i = 0; i < chat->max_idx; ++i) {\n         if (chat->peer_list[i].active) {",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410727709",
            "id": 410727709,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyNzcwOQ==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 435,
            "original_position": 247,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410727709/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410727709",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410728018"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728018"
                }
            },
            "author_association": "MEMBER",
            "body": "tmpnick? It took me a few seconds to figure out what \"nck\" means (is this a common abbreviation elsewhere in toxic?).",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:43:02Z",
            "diff_hunk": "@@ -598,6 +836,55 @@ static void groupchat_onKey(ToxWindow *self, Tox *m, wint_t key, bool ltr)\n     }\n }\n \n+static void draw_peer(ToxWindow *self, Tox *m, ChatContext *ctx, uint32_t i)\n+{\n+    pthread_mutex_lock(&Winthread.lock);\n+    const uint32_t peer_idx = i + groupchats[self->num].side_pos;\n+    const uint32_t peernum = groupchats[self->num].name_list[peer_idx].peernum;\n+    const bool is_self = tox_conference_peer_number_is_ours(m, self->num, peernum, NULL);\n+    const bool audio = groupchats[self->num].audio_enabled;\n+    pthread_mutex_unlock(&Winthread.lock);\n+\n+    /* truncate nick to fit in side panel without modifying list */\n+    char tmpnck[TOX_MAX_NAME_LENGTH];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410728018",
            "id": 410728018,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyODAxOA==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 849,
            "original_position": 525,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728018/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728018",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410728120"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728120"
                }
            },
            "author_association": "MEMBER",
            "body": "Move into for-init-decl?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:43:37Z",
            "diff_hunk": "@@ -631,38 +918,55 @@ static void groupchat_onDraw(ToxWindow *self, Tox *m)\n         mvwaddch(ctx->sidebar, y2 - CHATBOX_HEIGHT, 0, ACS_BTEE);\n \n         pthread_mutex_lock(&Winthread.lock);\n-        uint32_t num_peers = groupchats[self->num].num_peers;\n+        const uint32_t num_peers = groupchats[self->num].num_peers;\n+        const bool audio = groupchats[self->num].audio_enabled;\n+        const bool mic_on = audio && !device_is_muted(input, groupchats[self->num].audio_in_idx);\n+        const float volume = audio ? get_input_volume() : 0.0f;\n+        const float threshold = device_get_VAD_threshold(groupchats[self->num].audio_in_idx);\n+        const int header_lines = sidebar_offset(self->num);\n         pthread_mutex_unlock(&Winthread.lock);\n \n-        wmove(ctx->sidebar, 0, 1);\n-        wattron(ctx->sidebar, A_BOLD);\n-        wprintw(ctx->sidebar, \"Peers: %\"PRIu32\"\\n\", num_peers);\n-        wattroff(ctx->sidebar, A_BOLD);\n+        int line = 0;\n \n-        mvwaddch(ctx->sidebar, 1, 0, ACS_LTEE);\n-        mvwhline(ctx->sidebar, 1, 1, ACS_HLINE, SIDEBAR_WIDTH - 1);\n+        if (audio) {\n+            wmove(ctx->sidebar, line, 1);\n+            wattron(ctx->sidebar, A_BOLD);\n+            wprintw(ctx->sidebar, \"Mic: \");\n+            const int color = mic_on && volume > threshold ? GREEN : RED;\n+            wattron(ctx->sidebar, COLOR_PAIR(color));\n \n-        int maxlines = y2 - SDBAR_OFST - CHATBOX_HEIGHT;\n-        uint32_t i;\n+            if (mic_on) {\n+                float v = volume;\n \n-        for (i = 0; i < num_peers && i < maxlines; ++i) {\n-            wmove(ctx->sidebar, i + 2, 1);\n+                while (v > 0.0f) {\n+                    wprintw(ctx->sidebar, v > 10.0f ? (v > 15.0f ? \"*\" : \"+\") : (v > 5.0f ? \"-\" : \".\"));\n+                    v -= 20.0f;\n+                }\n+            } else {\n+                wprintw(ctx->sidebar, \"OFF\");\n+            }\n \n-            pthread_mutex_lock(&Winthread.lock);\n-            uint32_t peer = i + groupchats[self->num].side_pos;\n-            pthread_mutex_unlock(&Winthread.lock);\n+            wattroff(ctx->sidebar, COLOR_PAIR(color));\n+            wattroff(ctx->sidebar, A_BOLD);\n+            ++line;\n+        }\n \n-            /* truncate nick to fit in side panel without modifying list */\n-            char tmpnck[TOX_MAX_NAME_LENGTH];\n-            int maxlen = SIDEBAR_WIDTH - 2;\n+        wmove(ctx->sidebar, line, 1);\n+        wattron(ctx->sidebar, A_BOLD);\n+        wprintw(ctx->sidebar, \"Peers: %\"PRIu32\"\\n\", num_peers);\n+        wattroff(ctx->sidebar, A_BOLD);\n+        ++line;\n \n-            pthread_mutex_lock(&Winthread.lock);\n-            memcpy(tmpnck, &groupchats[self->num].name_list[peer * TOX_MAX_NAME_LENGTH], maxlen);\n-            pthread_mutex_unlock(&Winthread.lock);\n+        mvwaddch(ctx->sidebar, line, 0, ACS_LTEE);\n+        mvwhline(ctx->sidebar, line, 1, ACS_HLINE, SIDEBAR_WIDTH - 1);\n+        ++line;\n \n-            tmpnck[maxlen] = '\\0';\n+        int maxlines = y2 - header_lines - CHATBOX_HEIGHT;\n+        uint32_t i;",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410728120",
            "id": 410728120,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyODEyMA==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 965,
            "original_position": 636,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728120/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728120",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410728282"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728282"
                }
            },
            "author_association": "MEMBER",
            "body": "All of this code runs exactly 0 or 1 times per call to this function. It's a bit unclear because it's part of the loop body. If you factor out the \"find the peer\" bit into a function, then the \"act on the peer we meant\" bit can be behind an `if`. You could also handle the case of \"no peer found\", if there is something useful to do there (perhaps assert if that can't happen? Or else just return if it's normal).",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:45:00Z",
            "diff_hunk": "@@ -756,3 +1060,166 @@ static ToxWindow *new_group_chat(uint32_t groupnum)\n \n     return ret;\n }\n+\n+#ifdef AUDIO\n+\n+#define GROUPAV_SAMPLE_RATE 48000\n+#define GROUPAV_FRAME_DURATION 20\n+#define GROUPAV_AUDIO_CHANNELS 1\n+#define GROUPAV_SAMPLES_PER_FRAME (GROUPAV_SAMPLE_RATE * GROUPAV_FRAME_DURATION / 1000)\n+\n+void audio_group_callback(void *tox, uint32_t groupnumber, uint32_t peernumber, const int16_t *pcm,\n+                          unsigned int samples, uint8_t channels, uint32_t sample_rate, void *userdata)\n+{\n+    const GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active) {\n+        return;\n+    }\n+\n+    for (uint32_t i = 0; i < chat->max_idx; ++i) {\n+        GroupPeer *peer = &chat->peer_list[i];\n+\n+        if (!peer->active || peer->peernumber != peernumber) {\n+            continue;\n+        }\n+\n+        if (!peer->sending_audio) {\n+            if (open_output_device(&peer->audio_out_idx,\n+                                   sample_rate, GROUPAV_FRAME_DURATION, channels) != de_None) {\n+                // TODO: error message?\n+                return;\n+            }\n+\n+            peer->sending_audio = true;\n+\n+            set_peer_audio_position(tox, groupnumber, i);\n+        }\n+\n+        write_out(peer->audio_out_idx, pcm, samples, channels, sample_rate);\n+\n+        peer->last_audio_time = get_unix_time();\n+\n+        return;",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410728282",
            "id": 410728282,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyODI4Mg==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 1103,
            "original_position": 689,
            "original_start_line": 1087,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728282/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728282",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410728604"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728604"
                }
            },
            "author_association": "MEMBER",
            "body": "Redundant ().",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:48:45Z",
            "diff_hunk": "@@ -756,3 +1060,166 @@ static ToxWindow *new_group_chat(uint32_t groupnum)\n \n     return ret;\n }\n+\n+#ifdef AUDIO\n+\n+#define GROUPAV_SAMPLE_RATE 48000\n+#define GROUPAV_FRAME_DURATION 20\n+#define GROUPAV_AUDIO_CHANNELS 1\n+#define GROUPAV_SAMPLES_PER_FRAME (GROUPAV_SAMPLE_RATE * GROUPAV_FRAME_DURATION / 1000)\n+\n+void audio_group_callback(void *tox, uint32_t groupnumber, uint32_t peernumber, const int16_t *pcm,\n+                          unsigned int samples, uint8_t channels, uint32_t sample_rate, void *userdata)\n+{\n+    const GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active) {\n+        return;\n+    }\n+\n+    for (uint32_t i = 0; i < chat->max_idx; ++i) {\n+        GroupPeer *peer = &chat->peer_list[i];\n+\n+        if (!peer->active || peer->peernumber != peernumber) {\n+            continue;\n+        }\n+\n+        if (!peer->sending_audio) {\n+            if (open_output_device(&peer->audio_out_idx,\n+                                   sample_rate, GROUPAV_FRAME_DURATION, channels) != de_None) {\n+                // TODO: error message?\n+                return;\n+            }\n+\n+            peer->sending_audio = true;\n+\n+            set_peer_audio_position(tox, groupnumber, i);\n+        }\n+\n+        write_out(peer->audio_out_idx, pcm, samples, channels, sample_rate);\n+\n+        peer->last_audio_time = get_unix_time();\n+\n+        return;\n+    }\n+}\n+\n+static void group_read_device_callback(const int16_t *captured, uint32_t size, void *data)\n+{\n+    UNUSED_VAR(size);\n+\n+    AudioInputCallbackData *audio_input_callback_data = (AudioInputCallbackData *)data;\n+\n+    groupchats[audio_input_callback_data->groupnumber].last_sent_audio = get_unix_time();\n+\n+    toxav_group_send_audio(audio_input_callback_data->tox,\n+                           audio_input_callback_data->groupnumber,\n+                           captured, GROUPAV_SAMPLES_PER_FRAME,\n+                           GROUPAV_AUDIO_CHANNELS, GROUPAV_SAMPLE_RATE);\n+}\n+\n+bool init_group_audio_input(Tox *tox, uint32_t groupnumber)\n+{\n+    GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active || chat->audio_enabled) {\n+        return false;\n+    }\n+\n+    const AudioInputCallbackData audio_input_callback_data = { tox, groupnumber };\n+    chat->audio_input_callback_data = audio_input_callback_data;\n+\n+    bool success = (open_input_device(&chat->audio_in_idx,\n+                                      group_read_device_callback, &chat->audio_input_callback_data, true,\n+                                      GROUPAV_SAMPLE_RATE, GROUPAV_FRAME_DURATION, GROUPAV_AUDIO_CHANNELS)\n+                    == de_None);\n+\n+    chat->audio_enabled = success;\n+\n+    return success;\n+}\n+\n+bool enable_group_audio(Tox *tox, uint32_t groupnumber)\n+{\n+    if (!toxav_groupchat_av_enabled(tox, groupnumber)) {\n+        if (toxav_groupchat_enable_av(tox, groupnumber, audio_group_callback, NULL) != 0) {\n+            return false;\n+        }\n+    }\n+\n+    return init_group_audio_input(tox, groupnumber);\n+}\n+\n+bool disable_group_audio(Tox *tox, uint32_t groupnumber)\n+{\n+    GroupChat *chat = &groupchats[groupnumber];\n+\n+    if (!chat->active) {\n+        return false;\n+    }\n+\n+    if (chat->audio_enabled) {\n+        close_device(input, chat->audio_in_idx);\n+        chat->audio_enabled = false;\n+    }\n+\n+    return (toxav_groupchat_disable_av(tox, groupnumber) == 0);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410728604",
            "id": 410728604,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyODYwNA==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 1166,
            "original_position": 752,
            "original_start_line": null,
            "path": "src/groupchat.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728604/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728604",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410728855"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728855"
                }
            },
            "author_association": "MEMBER",
            "body": "Move to for-init-decl?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:50:45Z",
            "diff_hunk": "@@ -179,6 +179,26 @@ int bin_id_to_string(const char *bin_id, size_t bin_id_size, char *output, size_\n     return 0;\n }\n \n+/* Converts a binary representation of a Tox public key into a string.\n+ *\n+ * Returns 0 on success.\n+ * Returns -1 on failure.\n+ */\n+int bin_pubkey_to_string(const uint8_t *bin_pubkey, size_t bin_pubkey_size, char *output, size_t output_size)\n+{\n+    if (bin_pubkey_size != TOX_PUBLIC_KEY_SIZE || output_size < (TOX_PUBLIC_KEY_SIZE * 2 + 1)) {\n+        return -1;\n+    }\n+\n+    size_t i;",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410728855",
            "id": 410728855,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyODg1NQ==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 193,
            "original_position": 46,
            "original_start_line": null,
            "path": "src/misc_tools.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728855/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410728855",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410729449"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410729449"
                }
            },
            "author_association": "MEMBER",
            "body": "This goto doesn't seem worth it to me. There isn't any cleanup we're doing in the on_error part, and\r\n```\r\nprint_err(self, \"oh no something bad\"); return;\r\n```\r\nis shorter than\r\n```\r\nerror_str = \"oh no something bad\"; goto on_error;\r\n```\r\nwhile the latter costs more time to understand.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T17:56:38Z",
            "diff_hunk": "@@ -258,6 +266,47 @@ void callback_video_end(uint32_t friend_number)\n /*\n  * Commands from chat_commands.h\n  */\n+void cmd_vcall(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[MAX_STR_SIZE])\n+{\n+    UNUSED_VAR(window);\n+    UNUSED_VAR(m);\n+    UNUSED_VAR(argv);\n+\n+    const char *error_str;\n+\n+    if (argc != 0) {\n+        error_str = \"Unknown arguments.\";\n+        goto on_error;\n+    }\n+\n+    if (!CallControl.av) {\n+        error_str = \"ToxAV not supported!\";\n+        goto on_error;\n+    }\n+\n+    if (!self->stb->connection) {\n+        error_str = \"Friend is offline.\";\n+        goto on_error;\n+    }\n+\n+    Call *call = &CallControl.calls[self->num];\n+\n+    if (call->status != cs_None) {\n+        error_str = \"Already calling.\";\n+        goto on_error;\n+    }\n+\n+    init_call(call);\n+\n+    call->video_bit_rate = DEFAULT_VIDEO_BIT_RATE;\n+\n+    place_call(self);\n+\n+    return;\n+on_error:",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410729449",
            "id": 410729449,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyOTQ0OQ==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 306,
            "original_position": 205,
            "original_start_line": null,
            "path": "src/video_call.c",
            "position": null,
            "pull_request_review_id": 395934852,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410729449/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410729449",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410734580"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410734580"
                }
            },
            "author_association": "MEMBER",
            "body": "`video_bit_rate` doesn't exist when we build for `AUDIO` only (`!VIDEO`). Either make the existence of that unconditional or avoid its use when `!VIDEO`.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T18:40:36Z",
            "diff_hunk": "@@ -958,24 +907,67 @@ void cmd_bitrate(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)\n         goto on_error;\n     }\n \n+    call->audio_bit_rate = bit_rate;\n+\n     return;\n \n on_error:\n     print_err(self, error_str);\n }\n \n+void place_call(ToxWindow *self)\n+{\n+    Call *call = &CallControl.calls[self->num];\n+\n+    if (call->status != cs_Pending) {\n+        return;\n+    }\n+\n+    Toxav_Err_Call error;\n+    const char *error_str;\n+\n+    toxav_call(CallControl.av, self->num, call->audio_bit_rate, call->video_bit_rate, &error);",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410734580",
            "id": 410734580,
            "line": 869,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNDU4MA==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 869,
            "original_position": 908,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 1155,
            "pull_request_review_id": 395940029,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410734580/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410734580",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410738992"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410738992"
                }
            },
            "author_association": "MEMBER",
            "body": "Let's leave these as is.",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T19:15:49Z",
            "diff_hunk": "@@ -919,25 +841,39 @@ void cmd_bitrate(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)\n \n     char *error_str;\n \n-    if (argc != 1) {\n-        error_str = \"Must have value!\";\n+    Call *call = &CallControl.calls[self->num];",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410738992",
            "id": 410738992,
            "in_reply_to_id": 410689713,
            "line": 809,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODk5Mg==",
            "original_commit_id": "60beffa1ac13502857216310aff215f6bea22483",
            "original_line": 809,
            "original_position": 788,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": 1067,
            "pull_request_review_id": 395943032,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410738992/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410738992",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410739058"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410739058"
                }
            },
            "author_association": "MEMBER",
            "body": "I'm not convinced by this goto stuff here either. Do you want to keep it?",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-18T19:16:20Z",
            "diff_hunk": "@@ -918,25 +853,39 @@ void cmd_bitrate(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)\n \n     char *error_str;\n \n-    if (argc != 1) {\n-        error_str = \"Must have value!\";\n+    Call *call = &CallControl.calls[self->num];\n+\n+    if (call->status != cs_Active) {\n+        error_str = \"Must be in a call\";",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410739058",
            "id": 410739058,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczOTA1OA==",
            "original_commit_id": "48972344986fd109a2ddbea35d4b50a303af0034",
            "original_line": 859,
            "original_position": 847,
            "original_start_line": null,
            "path": "src/audio_call.c",
            "position": null,
            "pull_request_review_id": 395943081,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410739058/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410739058",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/toxic/pull/63#discussion_r410989767"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/63"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410989767"
                }
            },
            "author_association": "MEMBER",
            "body": "Needs \"self\".",
            "commit_id": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "created_at": "2020-04-19T20:57:58Z",
            "diff_hunk": "@@ -99,14 +99,14 @@ void cmd_enable_audio(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*\n     } else if (argc == 1 && !strcasecmp(argv[1], \"off\")) {\n         enable = false;\n     } else {\n-        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, \"Please specify: on | off\");\n+        print_err(self, \"Please specify: on | off\");\n         return;\n     }\n \n     if (enable ? enable_group_audio(m, self->num) : disable_group_audio(m, self->num)) {\n-        line_info_add(self, NULL, NULL, NULL, SYS_MSG, 0, 0, enable ? \"Enabled group audio\" : \"Disabled group audio\");\n+        print_err(enable ? \"Enabled group audio\" : \"Disabled group audio\");",
            "html_url": "https://github.com/TokTok/toxic/pull/63#discussion_r410989767",
            "id": 410989767,
            "line": null,
            "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDk4OTc2Nw==",
            "original_commit_id": "ffce9a85dc6b26e2136a0fea0115ac38fb73a422",
            "original_line": 107,
            "original_position": 26,
            "original_start_line": null,
            "path": "src/group_commands.c",
            "position": null,
            "pull_request_review_id": 396061373,
            "pull_request_url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410989767/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2020-11-14T18:01:46Z",
            "url": "https://api.github.com/repos/TokTok/toxic/pulls/comments/410989767",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "MEMBER",
            "body": ">> @@ -919,25 +841,39 @@ void cmd_bitrate(WINDOW *window, ToxWindow \n>> *self, Tox *m, int argc, char (*argv)\n>\n>     char *error_str;\n>\n>-    if (argc != 1) {\n>-        error_str = \"Must have value!\";\n>+    Call *call = &CallControl.calls[self->num];\n>\n>Can you make all of these `Call *const call = &...`? That way we don't \n>need to consider that it may be reassigned later in the function and \n>have a different meaning there.\n\nWhat do you mean by \"all\"? There are many pointers throughout the toxic \ncode which could be const, but almost all are not declared const. \nPerhaps this is because const pointer declarations are a little hard to \nread?\n",
            "created_at": "2020-04-18T14:18:54Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-615879233",
            "id": 615879233,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTg3OTIzMw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/615879233/reactions"
            },
            "updated_at": "2020-04-18T14:18:54Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/615879233",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">     for (uint8_t i = 0; i < MAX_WINDOWS_NUM; ++i) {\n>         if (windows[i] != NULL && windows[i]->onCancel != NULL && windows[i]->num == friend_number) {\n>\n>On third read, it seems you can generalise these functions entirely and make each of them 1 line.\n\nHow, sorry? How can you abstract onCancel?\n",
            "created_at": "2020-04-18T17:09:19Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-615905313",
            "id": 615905313,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTkwNTMxMw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/615905313/reactions"
            },
            "updated_at": "2020-04-18T17:09:19Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/615905313",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "* Saturday, 2020-04-18 at 10:10 -0700 - iphydf <notifications@github.com>:\n\n>+    if (pthread_create(&thread_id, NULL, poll_input, NULL) != 0 || pthread_detach(thread_id) != 0) {\n>\n>This violates MISRA C:2012 required rule 13.5: \"The right hand operand of a logical && or || operator shall not\n>contain persistent side effects\". Up to you whether you want to comply, though.\n\nCompromise: I added a newline to make the pthread_detach harder to miss.\n",
            "created_at": "2020-04-18T17:28:56Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-615908271",
            "id": 615908271,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTkwODI3MQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/615908271/reactions"
            },
            "updated_at": "2020-04-18T17:28:56Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/615908271",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            }
        },
        {
            "author_association": "NONE",
            "body": "## DeepCode's analysis on [#ba5ded](https://www.deepcode.ai/app/gh/TokTok/toxic/dac0124f0f620b288ac8739775c1716b5777fea0/TokTok/toxic/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142/pr/_/%2F/code/?utm_source=gh_review&c=0&w=1&i=0&) found:\n\n- :warning: **1** warning :point_down:\n## Top issues\n\n<table>\n  <thead>\n    <tr>\n      <th align=\"left\">Description</th>\n      <th align=\"left\">Example fixes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td width=\"77%\">Using strcpy can lead to severe buffer overflow vulnerabilities. Use the safe alternative strncpy instead. Occurrences: <ul><li><a href=\"https://github.com/TokTok/toxic/blob/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142/src/audio_device.c#L446\">audio_device.c:446</a></li></ul></td>\n      <td width=\"23%\"><a href=\"https://www.deepcode.ai/app/gh/TokTok/toxic/dac0124f0f620b288ac8739775c1716b5777fea0/TokTok/toxic/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142/pr/_/%2Fsrc%2Faudio_device.c/cpp%2Fdc%2FBufferOverflowUnsafeFunction/code/?utm_source=gh_review&\">:wrench: Example fixes</a></td>\n    </tr>\n  </tbody>\n</table>\n\n\n#### 👉 View analysis in [**DeepCode’s Dashboard**](https://www.deepcode.ai/app/gh/TokTok/toxic/dac0124f0f620b288ac8739775c1716b5777fea0/TokTok/toxic/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142/pr/_/%2F/code/?utm_source=gh_review&c=0&w=1&i=0&) | [_Configure the bot_](https://www.deepcode.ai/app/gh/?ownerconfig=TokTok)\n",
            "created_at": "2020-05-04T21:42:36Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-623723481",
            "id": 623723481,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzcyMzQ4MQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/623723481/reactions"
            },
            "updated_at": "2020-11-14T18:01:53Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/623723481",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
                "events_url": "https://api.github.com/users/ghost/events{/privacy}",
                "followers_url": "https://api.github.com/users/ghost/followers",
                "following_url": "https://api.github.com/users/ghost/following{/other_user}",
                "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ghost",
                "id": 10137,
                "login": "ghost",
                "node_id": "MDQ6VXNlcjEwMTM3",
                "organizations_url": "https://api.github.com/users/ghost/orgs",
                "received_events_url": "https://api.github.com/users/ghost/received_events",
                "repos_url": "https://api.github.com/users/ghost/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ghost"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "\n\n\n\n___\n*[src/audio_call.c, line 167 at r9](https://reviewable.io/reviews/toktok/toxic/63#-MM6b0Vj3AS56H6UPk59:-MM6b0VkAxXnem7cmXiq:b-both3p) ([raw file](https://github.com/toktok/toxic/blob/1c4bc505d8824add936d3df6e3ac150cc6224032/src/audio_call.c#L167)):*\n> ```C\n>     }\n> \n>     memset(call, 0, sizeof(Call));\n> ```\n\nToxic now uses compound literals instead of memset to zero structs. See: https://github.com/TokTok/toxic/pull/122\n\n\n<!-- Sent from Reviewable.io -->\n",
            "created_at": "2020-11-14T16:35:58Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-727232139",
            "id": 727232139,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzIzMjEzOQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727232139/reactions"
            },
            "updated_at": "2020-11-14T16:35:58Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727232139",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "\n\n\n\n___\n*[src/chat.c, line 748 at r9](https://reviewable.io/reviews/toktok/toxic/63#-MM6k5aR1iGDXrWQ9Xof:-MM6k5aR1iGDXrWQ9Xog:b9r82qc) ([raw file](https://github.com/toktok/toxic/blob/15b7a30925b7186d9fbd1507a8736c96f3392f13/src/chat.c#L748)):*\n> ```C\n> \n>     if (self->active_box != -1) {\n>         box_silent_notify2(self, NT_WNDALERT_2 | NT_NOFOCUS, self->active_box, \"invites you to join conference\");\n> ```\n\nThese should say `(\"Invites you to join conference %s\", name)` \n\nThis is because NGC will have a similar message and we will need to differentiate between the two\n\n\n<!-- Sent from Reviewable.io -->\n",
            "created_at": "2020-11-14T17:15:37Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-727237485",
            "id": 727237485,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzIzNzQ4NQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727237485/reactions"
            },
            "updated_at": "2020-11-14T17:15:37Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727237485",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "\n\n\n\n___\n*[src/chat_commands.h, line 50 at r9](https://reviewable.io/reviews/toktok/toxic/63#-MM6kZchA2yNUqu0pfg_:-MM6kZchA2yNUqu0pfga:b-c6a7s5) ([raw file](https://github.com/toktok/toxic/blob/1c4bc505d8824add936d3df6e3ac150cc6224032/src/chat_commands.h#L50)):*\n> ```objc\n> void cmd_vcall(WINDOW *, ToxWindow *, Tox *, int argc, char (*argv)[MAX_STR_SIZE]);\n> void cmd_video(WINDOW *, ToxWindow *, Tox *, int argc, char (*argv)[MAX_STR_SIZE]);\n> void cmd_res(WINDOW *window, ToxWindow *self, Tox *m, int argc, char (*argv)[MAX_STR_SIZE]);\n> ```\n\nWhy doesn't this follow the same format as the others? \n\n\n<!-- Sent from Reviewable.io -->\n",
            "created_at": "2020-11-14T17:17:10Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-727237688",
            "id": 727237688,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzIzNzY4OA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727237688/reactions"
            },
            "updated_at": "2020-11-14T17:17:10Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727237688",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "* Saturday, 2020-11-14 at 09:15 -0800 - JFreegman <notifications@github.com>:\n\n>___\n>*[src/chat.c, line 748 at r9](https://reviewable.io/reviews/toktok/toxic/63#-MM6k5aR1iGDXrWQ9Xof:-MM6k5aR1iGDXrWQ9Xog:b9r82qc) ([raw file](https://github.com/toktok/toxic/blob/15b7a30925b7186d9fbd1507a8736c96f3392f13/src/chat.c#L748)):*\n>> ```C\n>>\n>>     if (self->active_box != -1) {\n>>         box_silent_notify2(self, NT_WNDALERT_2 | NT_NOFOCUS, self->active_box, \"invites you to join conference\");\n>> ```\n>\n>These should say `(\"Invites you to join conference %s\", name)`\n>\n>This is because NGC will have a similar message and we will need to \n>differentiate between the two\n\n`name` is the name of the inviter, which is already shown.\n\nDoesn't \"conference\" versus \"group\" differentiate?\n",
            "created_at": "2020-11-16T08:02:35Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-727808324",
            "id": 727808324,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzgwODMyNA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727808324/reactions"
            },
            "updated_at": "2020-11-16T08:02:35Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/727808324",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> * Saturday, 2020-11-14 at 09:15 -0800 - JFreegman <notifications@github.com>:\r\n> ___ *[src/chat.c, line 748 at r9](https://reviewable.io/reviews/toktok/toxic/63#-MM6k5aR1iGDXrWQ9Xof:-MM6k5aR1iGDXrWQ9Xog:b9r82qc) ([raw file](https://github.com/toktok/toxic/blob/15b7a30925b7186d9fbd1507a8736c96f3392f13/src/chat.c#L748)):* > ```C > > if (self->active_box != -1) { > box_silent_notify2(self, NT_WNDALERT_2 | NT_NOFOCUS, self->active_box, \"invites you to join conference\"); > ``` These should say `(\"Invites you to join conference %s\", name)` This is because NGC will have a similar message and we will need to differentiate between the two\r\n> `name` is the name of the inviter, which is already shown. Doesn't \"conference\" versus \"group\" differentiate?\r\n\r\nGithub is showing the incorrect line. It's a few lines below that:\r\n\r\n>  box_silent_notify(self, NT_WNDALERT_2 | NT_NOFOCUS, &self->active_box, name, \"invites you to join %s\", description);",
            "created_at": "2020-11-16T16:01:31Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-728155253",
            "id": 728155253,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcyODE1NTI1Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/728155253/reactions"
            },
            "updated_at": "2020-11-16T16:01:31Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/728155253",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "* Monday, 2020-11-16 at 08:01 -0800 - JFreegman <notifications@github.com>:\n\n>> * Saturday, 2020-11-14 at 09:15 -0800 - JFreegman <notifications@github.com>:\n>>> These should say `(\"Invites you to join conference %s\", name)` This \n>>> is because NGC will have a similar message and we will need to \n>>> differentiate between the two\n>> `name` is the name of the inviter, which is already shown. Doesn't \n>> \"conference\" versus \"group\" differentiate?\n>\n>Github is showing the incorrect line. It's a few lines below that:\n>\n>>  box_silent_notify(self, NT_WNDALERT_2 | NT_NOFOCUS, \n>>  &self->active_box, name, \"invites you to join %s\", description);\n\nRight, but my comment and question stand. I don't see how to further \ndisambiguate.\n",
            "created_at": "2020-11-16T21:17:08Z",
            "html_url": "https://github.com/TokTok/toxic/pull/63#issuecomment-728334527",
            "id": 728334527,
            "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcyODMzNDUyNw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/728334527/reactions"
            },
            "updated_at": "2020-11-16T21:17:08Z",
            "url": "https://api.github.com/repos/TokTok/toxic/issues/comments/728334527",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/TokTok/toxic/issues/63/comments",
    "commit_data": [
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/daf794c4a203e2b2b6a84a471a10ebf19ecbdc86/comments",
            "commit": {
                "author": {
                    "date": "2020-04-04T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:01Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "Rework audio device handling\n\nWe now have at most one input and one output device open at any time,\nbut can have multiple capture callbacks and multiple output sources.",
                "tree": {
                    "sha": "a437edddd7cc2acc4ae21df4ef91718dec743988",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/a437edddd7cc2acc4ae21df4ef91718dec743988"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/daf794c4a203e2b2b6a84a471a10ebf19ecbdc86",
                "verification": {
                    "payload": "tree a437edddd7cc2acc4ae21df4ef91718dec743988\nparent dac0124f0f620b288ac8739775c1716b5777fea0\nauthor zugz <mbays+tox@sdf.org> 1585958400 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312001 +0000\n\nRework audio device handling\n\nWe now have at most one input and one output device open at any time,\nbut can have multiple capture callbacks and multiple output sources.\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgEACgkQbyvaKJ0E\n8kmnqQf+LeZCeya/lL08gf+aw2RDxhkdyM7TKjbsMYWeUuUKGbCnamZeS492foBE\nnzqqyXoy1LWiP9k0+peRaABsOG6MRqdZpqyiMqczvEd7LNGI71zuhmkJUbf6xgYi\nyBuAxGHLfnNcEqIfAfrF7SoSRWAw4SIR48PcTrVHtpdQQEOY//InnhAbuDmDK/gD\neuloZE6oykpkdl79DVMy7/spm1SOvkDwKA6oWXxycJ2VQV1E0RGyF4PCyHSVdAOB\nxFamGAYB7kYxT6MAjsGBR7uY7J6KDqGrYgROPw1A0Jsdc9WiOGJRIlt7LxIqVMou\njs52RldOfpbTEI9MkzEsVBGe+vHF7w==\n=VPqg\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/daf794c4a203e2b2b6a84a471a10ebf19ecbdc86",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OmRhZjc5NGM0YTIwM2UyYjJiNmE4NGE0NzFhMTBlYmYxOWVjYmRjODY=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/dac0124f0f620b288ac8739775c1716b5777fea0",
                    "sha": "dac0124f0f620b288ac8739775c1716b5777fea0",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/dac0124f0f620b288ac8739775c1716b5777fea0"
                }
            ],
            "sha": "daf794c4a203e2b2b6a84a471a10ebf19ecbdc86",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/daf794c4a203e2b2b6a84a471a10ebf19ecbdc86"
        },
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/ddcf224db22a88339529008ae89e8c89631d4d2f/comments",
            "commit": {
                "author": {
                    "date": "2020-05-07T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:01Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "Implement groupAV",
                "tree": {
                    "sha": "7d8b13da82331c69df42ea684049aa98d2c996f9",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/7d8b13da82331c69df42ea684049aa98d2c996f9"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/ddcf224db22a88339529008ae89e8c89631d4d2f",
                "verification": {
                    "payload": "tree 7d8b13da82331c69df42ea684049aa98d2c996f9\nparent daf794c4a203e2b2b6a84a471a10ebf19ecbdc86\nauthor zugz <mbays+tox@sdf.org> 1588809600 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312001 +0000\n\nImplement groupAV\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgEACgkQbyvaKJ0E\n8klDyAgAqYX8kFKwURuC584zmjQRwqZqNL8ttCt91QZG9XZnucjzN04Qf9elHabe\n3fM4yciOIScXx0zdgRdAMJKd45UeEj4nRg2wARM1UMCWmnlv+RTncJxFXtYW49Z0\nNfudTsCx7NqfPVYdJqrvCxkeU7jVez/p11esojzZBEtw1TZ/PnqpoeTS1pRPjuFR\nqy+aoS7tvZJuYho4xpIKiZMgimcIQK//YA3NX7koS1DmoBSnSnPU0a4XRL+lCzuc\nvG2hvb903W32B8xiLbxAFXbpT7aKCxFjsKYIqYOI5tlKJ95I76MQy36mu/8XC18c\nv5B3ftEHC/sXrvHQf5YjXIJVZNL8Sw==\n=ZjsS\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/ddcf224db22a88339529008ae89e8c89631d4d2f",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OmRkY2YyMjRkYjIyYTg4MzM5NTI5MDA4YWU4OWU4Yzg5NjMxZDRkMmY=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/daf794c4a203e2b2b6a84a471a10ebf19ecbdc86",
                    "sha": "daf794c4a203e2b2b6a84a471a10ebf19ecbdc86",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/daf794c4a203e2b2b6a84a471a10ebf19ecbdc86"
                }
            ],
            "sha": "ddcf224db22a88339529008ae89e8c89631d4d2f",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/ddcf224db22a88339529008ae89e8c89631d4d2f"
        },
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/7dead5ec961a52da4fa77537ae72b6a43c750377/comments",
            "commit": {
                "author": {
                    "date": "2020-05-07T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:01Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "Implement simplistic VAD",
                "tree": {
                    "sha": "d9266f3496bf631d38a125fdb355f82c7611dca5",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/d9266f3496bf631d38a125fdb355f82c7611dca5"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/7dead5ec961a52da4fa77537ae72b6a43c750377",
                "verification": {
                    "payload": "tree d9266f3496bf631d38a125fdb355f82c7611dca5\nparent ddcf224db22a88339529008ae89e8c89631d4d2f\nauthor zugz (tox) <mbays+tox@sdf.org> 1588809600 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312001 +0000\n\nImplement simplistic VAD\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgEACgkQbyvaKJ0E\n8knBTAgAlZlU/MnopaH5yUwKI63rdDkqWW3LuhdyXuwoXKjU4pPb85eefIUGdqfG\n0+1KoT7vklRLTKlyRfda+dYMtLBzXeODA3MRlYArlC9GYg4YrEZHsQ+e/mdkWBHN\njZ17Rr6TcsSvCvShmYJeTeEgz0EAOet/RZaevZSiR7vvsfFfLwmpURRNpUfBQrX6\n2rAB4mi8za+mgjp2Bsof4BPWLY9bJ3FR0dkN0ctBtrHJekhkSd/J1tKFWItbxMZF\nxccwmOwCqNpVCxnohDk31LxljObxBFAuscE3w7aTLe0IClTtLod7CM3jWeJ/yhuU\nyWX3aqQbL+UYach/RqfZv3inhRLMCw==\n=JYZB\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/7dead5ec961a52da4fa77537ae72b6a43c750377",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OjdkZWFkNWVjOTYxYTUyZGE0ZmE3NzUzN2FlNzJiNmE0M2M3NTAzNzc=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/ddcf224db22a88339529008ae89e8c89631d4d2f",
                    "sha": "ddcf224db22a88339529008ae89e8c89631d4d2f",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/ddcf224db22a88339529008ae89e8c89631d4d2f"
                }
            ],
            "sha": "7dead5ec961a52da4fa77537ae72b6a43c750377",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/7dead5ec961a52da4fa77537ae72b6a43c750377"
        },
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/4581dee4fc5c18e164c13e26e1d9dfb488534a4e/comments",
            "commit": {
                "author": {
                    "date": "2020-11-14T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:05Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "astyle",
                "tree": {
                    "sha": "529ef0d4f12952c298d6d7c05a76efebe07a9e83",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/529ef0d4f12952c298d6d7c05a76efebe07a9e83"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/4581dee4fc5c18e164c13e26e1d9dfb488534a4e",
                "verification": {
                    "payload": "tree 529ef0d4f12952c298d6d7c05a76efebe07a9e83\nparent d75d6e8b60763605694252bd5de9cca4adbdf93f\nauthor zugz (tox) <mbays+tox@sdf.org> 1605312000 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312005 +0000\n\nastyle\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgUACgkQbyvaKJ0E\n8kmEAggAl2zkuqw/SqtEqYxu9wstW4FiCNffghHhdAYsODrPAeGjmxeVLVMuY9Kq\n1HzIMJjDiks2RiV3JKOL3XFT40ezufEdMrr/QS8pLl89SMh+ExFR2VZJNzGm3yYi\ncPxJQHiDS4CMg0rShgt4zqIvV3STQ6VwHuF3GWM8ESZpBfbpjHoO0bIzx/CVtckD\nZqws0Ym88UpfX4/omWi6dsC7wYhENDFo9IlgbqXQLW5wBJ/eFwp5iKMVxK061jG+\ncEeWLdCVCU9kOeiQjsEPCBx6eT7z2fa22/HhucBcaLCx6FOauPMoDebV8WfwEvAm\ndEpXW2MRxXAe+kpLe6HZR1i9myp3ew==\n=npRM\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/4581dee4fc5c18e164c13e26e1d9dfb488534a4e",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OjQ1ODFkZWU0ZmM1YzE4ZTE2NGMxM2UyNmUxZDlkZmI0ODg1MzRhNGU=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/d75d6e8b60763605694252bd5de9cca4adbdf93f",
                    "sha": "d75d6e8b60763605694252bd5de9cca4adbdf93f",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/d75d6e8b60763605694252bd5de9cca4adbdf93f"
                }
            ],
            "sha": "4581dee4fc5c18e164c13e26e1d9dfb488534a4e",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/4581dee4fc5c18e164c13e26e1d9dfb488534a4e"
        },
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142/comments",
            "commit": {
                "author": {
                    "date": "2020-11-14T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:05Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "Use compound literals to zero out structs instead of memset",
                "tree": {
                    "sha": "6a8a83e0f13492ad1bf45643e9176a05083a113b",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/6a8a83e0f13492ad1bf45643e9176a05083a113b"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
                "verification": {
                    "payload": "tree 6a8a83e0f13492ad1bf45643e9176a05083a113b\nparent 4581dee4fc5c18e164c13e26e1d9dfb488534a4e\nauthor zugz (tox) <mbays+tox@sdf.org> 1605312000 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312005 +0000\n\nUse compound literals to zero out structs instead of memset\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgUACgkQbyvaKJ0E\n8kkOcwf+OCImB44MLXDPsEdWFJ8OjZstGKI8s2djMPk64WiMLkDyccGPUxz8huyi\nEjf2Gibxe102eMHQ9ap/Rn88lB0Vm/yAntCDUTUenKqTb/b9gtNYIFNRHcIKcF1a\ncDhco9GLTC3F8w5dpfvJOHOCc3TVsGA3eW5cvdKako4RQpcKqpLq0RvBeEcXGCF9\nYx8CMJV8Gymx5fDNY0C95XkWQIW3FX9CzSJYrgqG6QPrdYWOKrqpnUhErvotxEto\nwZjmfLPRD9p1ZYMG8p1Jj1M+lURrK/URnKKXkSvkp1rP3oNPCwyghB7xyZSL/VEs\nKAabCwSrlKX0Xd/005DZggjbQmsuag==\n=cODt\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OmJhNWRlZDliYzI3YThmMDZhYzk0YjU5YjIwODVkMmZhNjBkYzUxNDI=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/4581dee4fc5c18e164c13e26e1d9dfb488534a4e",
                    "sha": "4581dee4fc5c18e164c13e26e1d9dfb488534a4e",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/4581dee4fc5c18e164c13e26e1d9dfb488534a4e"
                }
            ],
            "sha": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142"
        },
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/142ce642f06adf25076ce550726e0b7ed0c7b81a/comments",
            "commit": {
                "author": {
                    "date": "2020-04-14T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:10Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "Per-call pending status and state handling\n\n* Proper handling of incoming video calls.\n* Add command /vcall for initiating video calls\n* Add command /res command to set video resolution",
                "tree": {
                    "sha": "1c4134fa4aeecaedbd64dff1f5158f1e98d3af81",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/1c4134fa4aeecaedbd64dff1f5158f1e98d3af81"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/142ce642f06adf25076ce550726e0b7ed0c7b81a",
                "verification": {
                    "payload": "tree 1c4134fa4aeecaedbd64dff1f5158f1e98d3af81\nparent 7dead5ec961a52da4fa77537ae72b6a43c750377\nauthor zugz (tox) <mbays+tox@sdf.org> 1586822400 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312010 +0000\n\nPer-call pending status and state handling\n\n* Proper handling of incoming video calls.\n* Add command /vcall for initiating video calls\n* Add command /res command to set video resolution\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgoACgkQbyvaKJ0E\n8kmN7gf9Fa8wDpFasd4Hq5838Q2WScjoJZ4SfwrI61ubU3rksdXwYAucf0wbZ7Oi\nWghWqiZbdnTSMYjUWXBt6a7OTZQh+C0p7du6QEwI6ozZEqjc7ltfCVL5kp1ntw9e\nBKlnmHszHRYBA3aZcjtgRB7LPU5PfmoD2wiABIZVoCfU+5Ic2XIbZ565y1W2wxfs\nUGnfYnvlp/5hjfksOBAKMJ+jp0gPwSx+1ctEYI9+B2txNpuRwR6OlT85fVGb7pfk\nYSZ+tcw3D814Ce3O2z3lhlObrvq0yEGnI+mqExV3E0+UPuLf8mQa7wOqgLTpTGua\n14QAKZFQUN9uN8eGl6bOW5bYEyuqLQ==\n=NZ0D\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/142ce642f06adf25076ce550726e0b7ed0c7b81a",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OjE0MmNlNjQyZjA2YWRmMjUwNzZjZTU1MDcyNmUwYjdlZDBjN2I4MWE=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/7dead5ec961a52da4fa77537ae72b6a43c750377",
                    "sha": "7dead5ec961a52da4fa77537ae72b6a43c750377",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/7dead5ec961a52da4fa77537ae72b6a43c750377"
                }
            ],
            "sha": "142ce642f06adf25076ce550726e0b7ed0c7b81a",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/142ce642f06adf25076ce550726e0b7ed0c7b81a"
        },
        {
            "author": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "comments_url": "https://api.github.com/repos/TokTok/toxic/commits/d75d6e8b60763605694252bd5de9cca4adbdf93f/comments",
            "commit": {
                "author": {
                    "date": "2020-04-18T00:00:00Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "comment_count": 0,
                "committer": {
                    "date": "2020-11-14T00:00:05Z",
                    "email": "mbays+tox@sdf.org",
                    "name": "zugz (tox)"
                },
                "message": "sort includes",
                "tree": {
                    "sha": "1711ddd48c9e1d5ff7e52210a6913e46386ed300",
                    "url": "https://api.github.com/repos/TokTok/toxic/git/trees/1711ddd48c9e1d5ff7e52210a6913e46386ed300"
                },
                "url": "https://api.github.com/repos/TokTok/toxic/git/commits/d75d6e8b60763605694252bd5de9cca4adbdf93f",
                "verification": {
                    "payload": "tree 1711ddd48c9e1d5ff7e52210a6913e46386ed300\nparent 142ce642f06adf25076ce550726e0b7ed0c7b81a\nauthor zugz (tox) <mbays+tox@sdf.org> 1587168000 +0000\ncommitter zugz (tox) <mbays+tox@sdf.org> 1605312005 +0000\n\nsort includes\n",
                    "reason": "valid",
                    "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEAqnhZrfTpeTogXGLbyvaKJ0E8kkFAl+vHgUACgkQbyvaKJ0E\n8knunQf+JQwGRCf+gC54IgZlFAbI5oeRLMgxcSGxVcgqpIOFh9gqx9DNPvllhk+6\naytoH8aOSB3KyCzysXdfB/0dTDC3nrXr4UCQomkOztNHXDJ+i+IiYWiRGQ5RCU+O\nri/+ndzmi6Vxj3/QURmIEVGm7J3RaCW+NVAd7iNnJHLX20VB1Ax65DBfOiqZcj9t\nbjURge+PHreuKsN1KTkkmmzx5HieUVfjRzTJygO5AdAiL1VLckbnfZzrzfaHwCiq\neF4M4ongV9LqjPmA2MUGQi+LsQePOpJnCEAPpEbdctWYGqjF20bRMUWMbS96lVPb\nqfiEUr7ao7KJb4ROkds8DkSSIdyRvQ==\n=U4Bm\n-----END PGP SIGNATURE-----",
                    "verified": true
                }
            },
            "committer": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "html_url": "https://github.com/TokTok/toxic/commit/d75d6e8b60763605694252bd5de9cca4adbdf93f",
            "node_id": "MDY6Q29tbWl0MTA4NzQ4MDc4OmQ3NWQ2ZThiNjA3NjM2MDU2OTQyNTJiZDVkZTljY2E0YWRiZGY5M2Y=",
            "parents": [
                {
                    "html_url": "https://github.com/TokTok/toxic/commit/142ce642f06adf25076ce550726e0b7ed0c7b81a",
                    "sha": "142ce642f06adf25076ce550726e0b7ed0c7b81a",
                    "url": "https://api.github.com/repos/TokTok/toxic/commits/142ce642f06adf25076ce550726e0b7ed0c7b81a"
                }
            ],
            "sha": "d75d6e8b60763605694252bd5de9cca4adbdf93f",
            "url": "https://api.github.com/repos/TokTok/toxic/commits/d75d6e8b60763605694252bd5de9cca4adbdf93f"
        }
    ],
    "commits_url": "https://api.github.com/repos/TokTok/toxic/pulls/63/commits",
    "created_at": "2020-04-13T19:42:29Z",
    "diff_url": "https://github.com/TokTok/toxic/pull/63.diff",
    "draft": false,
    "head": {
        "label": "zugz:sanerCallControl",
        "ref": "sanerCallControl",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/zugz/toxic/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/zugz/toxic/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/zugz/toxic/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/zugz/toxic/branches{/branch}",
            "clone_url": "https://github.com/zugz/toxic.git",
            "collaborators_url": "https://api.github.com/repos/zugz/toxic/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/zugz/toxic/comments{/number}",
            "commits_url": "https://api.github.com/repos/zugz/toxic/commits{/sha}",
            "compare_url": "https://api.github.com/repos/zugz/toxic/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/zugz/toxic/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/zugz/toxic/contributors",
            "created_at": "2017-10-29T15:51:44Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/zugz/toxic/deployments",
            "description": "An ncurses-based Tox client",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/zugz/toxic/downloads",
            "events_url": "https://api.github.com/repos/zugz/toxic/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/zugz/toxic/forks",
            "full_name": "zugz/toxic",
            "git_commits_url": "https://api.github.com/repos/zugz/toxic/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/zugz/toxic/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/zugz/toxic/git/tags{/sha}",
            "git_url": "git://github.com/zugz/toxic.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "",
            "hooks_url": "https://api.github.com/repos/zugz/toxic/hooks",
            "html_url": "https://github.com/zugz/toxic",
            "id": 108748078,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/zugz/toxic/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/zugz/toxic/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/zugz/toxic/issues{/number}",
            "keys_url": "https://api.github.com/repos/zugz/toxic/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/zugz/toxic/labels{/name}",
            "language": "C",
            "languages_url": "https://api.github.com/repos/zugz/toxic/languages",
            "license": {
                "key": "gpl-3.0",
                "name": "GNU General Public License v3.0",
                "node_id": "MDc6TGljZW5zZTk=",
                "spdx_id": "GPL-3.0",
                "url": "https://api.github.com/licenses/gpl-3.0"
            },
            "merges_url": "https://api.github.com/repos/zugz/toxic/merges",
            "milestones_url": "https://api.github.com/repos/zugz/toxic/milestones{/number}",
            "mirror_url": null,
            "name": "toxic",
            "node_id": "MDEwOlJlcG9zaXRvcnkxMDg3NDgwNzg=",
            "notifications_url": "https://api.github.com/repos/zugz/toxic/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
                "events_url": "https://api.github.com/users/zugz/events{/privacy}",
                "followers_url": "https://api.github.com/users/zugz/followers",
                "following_url": "https://api.github.com/users/zugz/following{/other_user}",
                "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zugz",
                "id": 590069,
                "login": "zugz",
                "node_id": "MDQ6VXNlcjU5MDA2OQ==",
                "organizations_url": "https://api.github.com/users/zugz/orgs",
                "received_events_url": "https://api.github.com/users/zugz/received_events",
                "repos_url": "https://api.github.com/users/zugz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zugz"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/zugz/toxic/pulls{/number}",
            "pushed_at": "2020-11-16T20:34:28Z",
            "releases_url": "https://api.github.com/repos/zugz/toxic/releases{/id}",
            "size": 16778,
            "ssh_url": "git@github.com:zugz/toxic.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/zugz/toxic/stargazers",
            "statuses_url": "https://api.github.com/repos/zugz/toxic/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/zugz/toxic/subscribers",
            "subscription_url": "https://api.github.com/repos/zugz/toxic/subscription",
            "svn_url": "https://github.com/zugz/toxic",
            "tags_url": "https://api.github.com/repos/zugz/toxic/tags",
            "teams_url": "https://api.github.com/repos/zugz/toxic/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/zugz/toxic/git/trees{/sha}",
            "updated_at": "2020-11-16T20:22:59Z",
            "url": "https://api.github.com/repos/zugz/toxic",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
            "events_url": "https://api.github.com/users/zugz/events{/privacy}",
            "followers_url": "https://api.github.com/users/zugz/followers",
            "following_url": "https://api.github.com/users/zugz/following{/other_user}",
            "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zugz",
            "id": 590069,
            "login": "zugz",
            "node_id": "MDQ6VXNlcjU5MDA2OQ==",
            "organizations_url": "https://api.github.com/users/zugz/orgs",
            "received_events_url": "https://api.github.com/users/zugz/received_events",
            "repos_url": "https://api.github.com/users/zugz/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zugz"
        }
    },
    "html_url": "https://github.com/TokTok/toxic/pull/63",
    "id": 402805697,
    "issue_url": "https://api.github.com/repos/TokTok/toxic/issues/63",
    "labels": [
        {
            "color": "fef2c0",
            "default": false,
            "description": "Refactoring production code, eg. renaming a variable, not affecting semantics",
            "id": 2036830938,
            "name": "refactor",
            "node_id": "MDU6TGFiZWwyMDM2ODMwOTM4",
            "url": "https://api.github.com/repos/TokTok/toxic/labels/refactor"
        }
    ],
    "locked": false,
    "merge_commit_sha": "ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
    "merged_at": "2020-11-14T18:35:14Z",
    "milestone": {
        "closed_at": "2021-12-11T22:20:00Z",
        "closed_issues": 104,
        "created_at": "2020-04-26T18:19:17Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
            "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
            "followers_url": "https://api.github.com/users/iphydf/followers",
            "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
            "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/iphydf",
            "id": 10647936,
            "login": "iphydf",
            "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
            "organizations_url": "https://api.github.com/users/iphydf/orgs",
            "received_events_url": "https://api.github.com/users/iphydf/received_events",
            "repos_url": "https://api.github.com/users/iphydf/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/iphydf"
        },
        "description": null,
        "due_on": null,
        "html_url": "https://github.com/TokTok/toxic/milestone/1",
        "id": 5350436,
        "labels_url": "https://api.github.com/repos/TokTok/toxic/milestones/1/labels",
        "node_id": "MDk6TWlsZXN0b25lNTM1MDQzNg==",
        "number": 1,
        "open_issues": 0,
        "state": "closed",
        "title": "0.8.x",
        "updated_at": "2021-12-11T22:20:00Z",
        "url": "https://api.github.com/repos/TokTok/toxic/milestones/1"
    },
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDAyODA1Njk3",
    "number": 63,
    "patch_url": "https://github.com/TokTok/toxic/pull/63.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/TokTok/toxic/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/TokTok/toxic/pulls/63/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/TokTok/toxic/statuses/ba5ded9bc27a8f06ac94b59b2085d2fa60dc5142",
    "title": "refactor: Saner call control",
    "updated_at": "2020-11-16T21:17:08Z",
    "url": "https://api.github.com/repos/TokTok/toxic/pulls/63",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/590069?v=4",
        "events_url": "https://api.github.com/users/zugz/events{/privacy}",
        "followers_url": "https://api.github.com/users/zugz/followers",
        "following_url": "https://api.github.com/users/zugz/following{/other_user}",
        "gists_url": "https://api.github.com/users/zugz/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zugz",
        "id": 590069,
        "login": "zugz",
        "node_id": "MDQ6VXNlcjU5MDA2OQ==",
        "organizations_url": "https://api.github.com/users/zugz/orgs",
        "received_events_url": "https://api.github.com/users/zugz/received_events",
        "repos_url": "https://api.github.com/users/zugz/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zugz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zugz/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zugz"
    }
}