{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "I was trying to update some old code which was still using the `msgpack` package, so I tried switching to this fork. I see the `MessagePack` class now has\r\n```haskell\r\nfromObject :: (Applicative m, Monad m) => Object -> m a\r\n```\r\ninstead of\r\n```haskell\r\nfromObject :: Object -> Maybe a\r\n```\r\nCan you explain the rationale for this change? I see no reason why `fromObject` needs to work polymorphically over all monads, it has nothing to do with monads at all! You end up using just the `fail` method for all your instances. At best, you could change `Maybe a` to `Either Error a` using an `Error` datatype.",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Using `Either` seems reasonable. What I really want here is `MonadFail`, but that's currently not portable to all the targets I want to support. `fromObject` does have a lot to do with monads, though, and the polymorphic definition is mostly compatible with code that uses `Maybe`, while changing it to another concrete instance of `Monad` is incompatible.\r\n\r\nWhy do you say it has nothing to do with monads? For the simplest cases, it requires at least `Functor`, and for slightly more complex cases (product types), it will need `Applicative`. In general, it's entirely reasonable to need a `Monad` for decoding values, e.g. when decoding sum types: you need to first decode the object to `(Int, Object)`, use the `Int` to select the constructor, and then decode the `Object` to its arguments.\r\n\r\nYou're arguing for using a specific instance of `Monad` rather than abstracting over arbitrary ones. I changed this, because I wanted to allow users to run `fromObject` in an arbitrary monad, such as `Data.Binary.Get`. I can be convinced to use `Either`, instead, but it would be an incompatible change.\r\n\r\nWhy do you feel this is a problem? Are you running into performance issues due to the abstraction?",
            "created_at": "2016-11-25T16:42:41Z",
            "html_url": "https://github.com/TokTok/hs-msgpack-binary/issues/30#issuecomment-262994280",
            "id": 262994280,
            "issue_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2Mjk5NDI4MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/comments/262994280/reactions"
            },
            "updated_at": "2016-11-25T16:42:41Z",
            "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/comments/262994280",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf"
            }
        },
        {
            "author_association": "NONE",
            "body": "Do not change please. It's perfectly fine the way it is now.",
            "created_at": "2016-11-25T18:27:38Z",
            "html_url": "https://github.com/TokTok/hs-msgpack-binary/issues/30#issuecomment-263008324",
            "id": 263008324,
            "issue_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzAwODMyNA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/comments/263008324/reactions"
            },
            "updated_at": "2016-11-25T18:27:38Z",
            "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/comments/263008324",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/754754?v=4",
                "events_url": "https://api.github.com/users/SX91/events{/privacy}",
                "followers_url": "https://api.github.com/users/SX91/followers",
                "following_url": "https://api.github.com/users/SX91/following{/other_user}",
                "gists_url": "https://api.github.com/users/SX91/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/SX91",
                "id": 754754,
                "login": "SX91",
                "node_id": "MDQ6VXNlcjc1NDc1NA==",
                "organizations_url": "https://api.github.com/users/SX91/orgs",
                "received_events_url": "https://api.github.com/users/SX91/received_events",
                "repos_url": "https://api.github.com/users/SX91/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/SX91/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/SX91/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/SX91"
            }
        },
        {
            "author_association": "NONE",
            "body": "The problem I am experiencing with this change, unless I am missing something fundamental about Haskell, is that it is impossible to handle failure in a generic way.\r\n\r\nWhen fromObject returned a `Maybe`, it was trivial to detect and handle failures, so you could write something like this:\r\n\r\n```\r\nnewtype Wrapper a = Wrapper a\r\n\r\ninstance MessagePack a => MessagePack (Wrapper a) where\r\n  fromObject (Wrapper a) = msum [fromObject [a], fromObject a]\r\n```\r\n\r\nI don't think you can do the equivalent with the new implementation, as failure may have a completely different manifestation depending on the monad?",
            "created_at": "2018-05-09T10:12:04Z",
            "html_url": "https://github.com/TokTok/hs-msgpack-binary/issues/30#issuecomment-387691508",
            "id": 387691508,
            "issue_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4NzY5MTUwOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/comments/387691508/reactions"
            },
            "updated_at": "2018-05-09T10:12:04Z",
            "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/comments/387691508",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/149323?v=4",
                "events_url": "https://api.github.com/users/devwout/events{/privacy}",
                "followers_url": "https://api.github.com/users/devwout/followers",
                "following_url": "https://api.github.com/users/devwout/following{/other_user}",
                "gists_url": "https://api.github.com/users/devwout/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/devwout",
                "id": 149323,
                "login": "devwout",
                "node_id": "MDQ6VXNlcjE0OTMyMw==",
                "organizations_url": "https://api.github.com/users/devwout/orgs",
                "received_events_url": "https://api.github.com/users/devwout/received_events",
                "repos_url": "https://api.github.com/users/devwout/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/devwout/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/devwout/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/devwout"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30/comments",
    "created_at": "2016-11-24T22:25:36Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30/events",
    "html_url": "https://github.com/TokTok/hs-msgpack-binary/issues/30",
    "id": 191597660,
    "labels": [],
    "labels_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUxOTE1OTc2NjA=",
    "number": 30,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30/reactions"
    },
    "repository_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30/timeline",
    "title": "Why did fromObject change?",
    "updated_at": "2018-05-09T10:12:04Z",
    "url": "https://api.github.com/repos/TokTok/hs-msgpack-binary/issues/30",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/213959?v=4",
        "events_url": "https://api.github.com/users/vikraman/events{/privacy}",
        "followers_url": "https://api.github.com/users/vikraman/followers",
        "following_url": "https://api.github.com/users/vikraman/following{/other_user}",
        "gists_url": "https://api.github.com/users/vikraman/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/vikraman",
        "id": 213959,
        "login": "vikraman",
        "node_id": "MDQ6VXNlcjIxMzk1OQ==",
        "organizations_url": "https://api.github.com/users/vikraman/orgs",
        "received_events_url": "https://api.github.com/users/vikraman/received_events",
        "repos_url": "https://api.github.com/users/vikraman/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/vikraman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/vikraman/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/vikraman"
    }
}